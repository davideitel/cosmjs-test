import t from"buffer";var i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var r={};var e={exports:r};(function(r,e){function assert(t,i){if(!t)throw new Error(i||"Assertion failed")}function inherits(t,i){t.super_=i;var TempCtor=function(){};TempCtor.prototype=i.prototype;t.prototype=new TempCtor;t.prototype.constructor=t}function BN(t,r,e){if(BN.isBN(t))return t;(this||i).negative=0;(this||i).words=null;(this||i).length=0;(this||i).red=null;if(null!==t){if("le"===r||"be"===r){e=r;r=10}this._init(t||0,r||10,e||"be")}}"object"===typeof r?r.exports=BN:e.BN=BN;BN.BN=BN;BN.wordSize=26;var n;try{n="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:t.Buffer}catch(t){}BN.isBN=function isBN(t){return t instanceof BN||null!==t&&"object"===typeof t&&t.constructor.wordSize===BN.wordSize&&Array.isArray(t.words)};BN.max=function max(t,i){return t.cmp(i)>0?t:i};BN.min=function min(t,i){return t.cmp(i)<0?t:i};BN.prototype._init=function init(t,r,e){if("number"===typeof t)return this._initNumber(t,r,e);if("object"===typeof t)return this._initArray(t,r,e);"hex"===r&&(r=16);assert(r===(0|r)&&r>=2&&r<=36);t=t.toString().replace(/\s+/g,"");var n=0;if("-"===t[0]){n++;(this||i).negative=1}if(n<t.length)if(16===r)this._parseHex(t,n,e);else{this._parseBase(t,r,n);"le"===e&&this._initArray(this.toArray(),r,e)}};BN.prototype._initNumber=function _initNumber(t,r,e){if(t<0){(this||i).negative=1;t=-t}if(t<67108864){(this||i).words=[67108863&t];(this||i).length=1}else if(t<4503599627370496){(this||i).words=[67108863&t,t/67108864&67108863];(this||i).length=2}else{assert(t<9007199254740992);(this||i).words=[67108863&t,t/67108864&67108863,1];(this||i).length=3}"le"===e&&this._initArray(this.toArray(),r,e)};BN.prototype._initArray=function _initArray(t,r,e){assert("number"===typeof t.length);if(t.length<=0){(this||i).words=[0];(this||i).length=1;return this||i}(this||i).length=Math.ceil(t.length/3);(this||i).words=new Array((this||i).length);for(var n=0;n<(this||i).length;n++)(this||i).words[n]=0;var h,s;var o=0;if("be"===e)for(n=t.length-1,h=0;n>=0;n-=3){s=t[n]|t[n-1]<<8|t[n-2]<<16;(this||i).words[h]|=s<<o&67108863;(this||i).words[h+1]=s>>>26-o&67108863;o+=24;if(o>=26){o-=26;h++}}else if("le"===e)for(n=0,h=0;n<t.length;n+=3){s=t[n]|t[n+1]<<8|t[n+2]<<16;(this||i).words[h]|=s<<o&67108863;(this||i).words[h+1]=s>>>26-o&67108863;o+=24;if(o>=26){o-=26;h++}}return this._strip()};function parseHex4Bits(t,i){var r=t.charCodeAt(i);if(r>=48&&r<=57)return r-48;if(r>=65&&r<=70)return r-55;if(r>=97&&r<=102)return r-87;assert(false,"Invalid character in "+t)}function parseHexByte(t,i,r){var e=parseHex4Bits(t,r);r-1>=i&&(e|=parseHex4Bits(t,r-1)<<4);return e}BN.prototype._parseHex=function _parseHex(t,r,e){(this||i).length=Math.ceil((t.length-r)/6);(this||i).words=new Array((this||i).length);for(var n=0;n<(this||i).length;n++)(this||i).words[n]=0;var h=0;var s=0;var o;if("be"===e)for(n=t.length-1;n>=r;n-=2){o=parseHexByte(t,r,n)<<h;(this||i).words[s]|=67108863&o;if(h>=18){h-=18;s+=1;(this||i).words[s]|=o>>>26}else h+=8}else{var a=t.length-r;for(n=a%2===0?r+1:r;n<t.length;n+=2){o=parseHexByte(t,r,n)<<h;(this||i).words[s]|=67108863&o;if(h>=18){h-=18;s+=1;(this||i).words[s]|=o>>>26}else h+=8}}this._strip()};function parseBase(t,i,r,e){var n=0;var h=0;var s=Math.min(t.length,r);for(var o=i;o<s;o++){var a=t.charCodeAt(o)-48;n*=e;h=a>=49?a-49+10:a>=17?a-17+10:a;assert(a>=0&&h<e,"Invalid character");n+=h}return n}BN.prototype._parseBase=function _parseBase(t,r,e){(this||i).words=[0];(this||i).length=1;for(var n=0,h=1;h<=67108863;h*=r)n++;n--;h=h/r|0;var s=t.length-e;var o=s%n;var a=Math.min(s,s-o)+e;var u=0;for(var l=e;l<a;l+=n){u=parseBase(t,l,l+n,r);this.imuln(h);(this||i).words[0]+u<67108864?(this||i).words[0]+=u:this._iaddn(u)}if(0!==o){var m=1;u=parseBase(t,l,t.length,r);for(l=0;l<o;l++)m*=r;this.imuln(m);(this||i).words[0]+u<67108864?(this||i).words[0]+=u:this._iaddn(u)}this._strip()};BN.prototype.copy=function copy(t){t.words=new Array((this||i).length);for(var r=0;r<(this||i).length;r++)t.words[r]=(this||i).words[r];t.length=(this||i).length;t.negative=(this||i).negative;t.red=(this||i).red};function move(t,i){t.words=i.words;t.length=i.length;t.negative=i.negative;t.red=i.red}BN.prototype._move=function _move(t){move(t,this||i)};BN.prototype.clone=function clone(){var t=new BN(null);this.copy(t);return t};BN.prototype._expand=function _expand(t){while((this||i).length<t)(this||i).words[(this||i).length++]=0;return this||i};BN.prototype._strip=function strip(){while((this||i).length>1&&0===(this||i).words[(this||i).length-1])(this||i).length--;return this._normSign()};BN.prototype._normSign=function _normSign(){1===(this||i).length&&0===(this||i).words[0]&&((this||i).negative=0);return this||i};if("undefined"!==typeof Symbol&&"function"===typeof Symbol.for)try{BN.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspect}catch(t){BN.prototype.inspect=inspect}else BN.prototype.inspect=inspect;function inspect(){return((this||i).red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var s=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var o=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function toString(t,r){t=t||10;r=0|r||1;var e;if(16===t||"hex"===t){e="";var n=0;var a=0;for(var u=0;u<(this||i).length;u++){var l=(this||i).words[u];var m=(16777215&(l<<n|a)).toString(16);a=l>>>24-n&16777215;e=0!==a||u!==(this||i).length-1?h[6-m.length]+m+e:m+e;n+=2;if(n>=26){n-=26;u--}}0!==a&&(e=a.toString(16)+e);while(e.length%r!==0)e="0"+e;0!==(this||i).negative&&(e="-"+e);return e}if(t===(0|t)&&t>=2&&t<=36){var f=s[t];var d=o[t];e="";var v=this.clone();v.negative=0;while(!v.isZero()){var p=v.modrn(d).toString(t);v=v.idivn(d);e=v.isZero()?p+e:h[f-p.length]+p+e}this.isZero()&&(e="0"+e);while(e.length%r!==0)e="0"+e;0!==(this||i).negative&&(e="-"+e);return e}assert(false,"Base should be between 2 and 36")};BN.prototype.toNumber=function toNumber(){var t=(this||i).words[0];2===(this||i).length?t+=67108864*(this||i).words[1]:3===(this||i).length&&1===(this||i).words[2]?t+=4503599627370496+67108864*(this||i).words[1]:(this||i).length>2&&assert(false,"Number can only safely store up to 53 bits");return 0!==(this||i).negative?-t:t};BN.prototype.toJSON=function toJSON(){return this.toString(16,2)};n&&(BN.prototype.toBuffer=function toBuffer(t,i){return this.toArrayLike(n,t,i)});BN.prototype.toArray=function toArray(t,i){return this.toArrayLike(Array,t,i)};var a=function allocate(t,i){return t.allocUnsafe?t.allocUnsafe(i):new t(i)};BN.prototype.toArrayLike=function toArrayLike(t,i,r){this._strip();var e=this.byteLength();var n=r||Math.max(1,e);assert(e<=n,"byte array longer than desired length");assert(n>0,"Requested array length <= 0");var h=a(t,n);var s="le"===i?"LE":"BE";this["_toArrayLike"+s](h,e);return h};BN.prototype._toArrayLikeLE=function _toArrayLikeLE(t,r){var e=0;var n=0;for(var h=0,s=0;h<(this||i).length;h++){var o=(this||i).words[h]<<s|n;t[e++]=255&o;e<t.length&&(t[e++]=o>>8&255);e<t.length&&(t[e++]=o>>16&255);if(6===s){e<t.length&&(t[e++]=o>>24&255);n=0;s=0}else{n=o>>>24;s+=2}}if(e<t.length){t[e++]=n;while(e<t.length)t[e++]=0}};BN.prototype._toArrayLikeBE=function _toArrayLikeBE(t,r){var e=t.length-1;var n=0;for(var h=0,s=0;h<(this||i).length;h++){var o=(this||i).words[h]<<s|n;t[e--]=255&o;e>=0&&(t[e--]=o>>8&255);e>=0&&(t[e--]=o>>16&255);if(6===s){e>=0&&(t[e--]=o>>24&255);n=0;s=0}else{n=o>>>24;s+=2}}if(e>=0){t[e--]=n;while(e>=0)t[e--]=0}};Math.clz32?BN.prototype._countBits=function _countBits(t){return 32-Math.clz32(t)}:BN.prototype._countBits=function _countBits(t){var i=t;var r=0;if(i>=4096){r+=13;i>>>=13}if(i>=64){r+=7;i>>>=7}if(i>=8){r+=4;i>>>=4}if(i>=2){r+=2;i>>>=2}return r+i};BN.prototype._zeroBits=function _zeroBits(t){if(0===t)return 26;var i=t;var r=0;if(0===(8191&i)){r+=13;i>>>=13}if(0===(127&i)){r+=7;i>>>=7}if(0===(15&i)){r+=4;i>>>=4}if(0===(3&i)){r+=2;i>>>=2}0===(1&i)&&r++;return r};BN.prototype.bitLength=function bitLength(){var t=(this||i).words[(this||i).length-1];var r=this._countBits(t);return 26*((this||i).length-1)+r};function toBitArray(t){var i=new Array(t.bitLength());for(var r=0;r<i.length;r++){var e=r/26|0;var n=r%26;i[r]=t.words[e]>>>n&1}return i}BN.prototype.zeroBits=function zeroBits(){if(this.isZero())return 0;var t=0;for(var r=0;r<(this||i).length;r++){var e=this._zeroBits((this||i).words[r]);t+=e;if(26!==e)break}return t};BN.prototype.byteLength=function byteLength(){return Math.ceil(this.bitLength()/8)};BN.prototype.toTwos=function toTwos(t){return 0!==(this||i).negative?this.abs().inotn(t).iaddn(1):this.clone()};BN.prototype.fromTwos=function fromTwos(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()};BN.prototype.isNeg=function isNeg(){return 0!==(this||i).negative};BN.prototype.neg=function neg(){return this.clone().ineg()};BN.prototype.ineg=function ineg(){this.isZero()||((this||i).negative^=1);return this||i};BN.prototype.iuor=function iuor(t){while((this||i).length<t.length)(this||i).words[(this||i).length++]=0;for(var r=0;r<t.length;r++)(this||i).words[r]=(this||i).words[r]|t.words[r];return this._strip()};BN.prototype.ior=function ior(t){assert(0===((this||i).negative|t.negative));return this.iuor(t)};BN.prototype.or=function or(t){return(this||i).length>t.length?this.clone().ior(t):t.clone().ior(this||i)};BN.prototype.uor=function uor(t){return(this||i).length>t.length?this.clone().iuor(t):t.clone().iuor(this||i)};BN.prototype.iuand=function iuand(t){var r;r=(this||i).length>t.length?t:this||i;for(var e=0;e<r.length;e++)(this||i).words[e]=(this||i).words[e]&t.words[e];(this||i).length=r.length;return this._strip()};BN.prototype.iand=function iand(t){assert(0===((this||i).negative|t.negative));return this.iuand(t)};BN.prototype.and=function and(t){return(this||i).length>t.length?this.clone().iand(t):t.clone().iand(this||i)};BN.prototype.uand=function uand(t){return(this||i).length>t.length?this.clone().iuand(t):t.clone().iuand(this||i)};BN.prototype.iuxor=function iuxor(t){var r;var e;if((this||i).length>t.length){r=this||i;e=t}else{r=t;e=this||i}for(var n=0;n<e.length;n++)(this||i).words[n]=r.words[n]^e.words[n];if((this||i)!==r)for(;n<r.length;n++)(this||i).words[n]=r.words[n];(this||i).length=r.length;return this._strip()};BN.prototype.ixor=function ixor(t){assert(0===((this||i).negative|t.negative));return this.iuxor(t)};BN.prototype.xor=function xor(t){return(this||i).length>t.length?this.clone().ixor(t):t.clone().ixor(this||i)};BN.prototype.uxor=function uxor(t){return(this||i).length>t.length?this.clone().iuxor(t):t.clone().iuxor(this||i)};BN.prototype.inotn=function inotn(t){assert("number"===typeof t&&t>=0);var r=0|Math.ceil(t/26);var e=t%26;this._expand(r);e>0&&r--;for(var n=0;n<r;n++)(this||i).words[n]=67108863&~(this||i).words[n];e>0&&((this||i).words[n]=~(this||i).words[n]&67108863>>26-e);return this._strip()};BN.prototype.notn=function notn(t){return this.clone().inotn(t)};BN.prototype.setn=function setn(t,r){assert("number"===typeof t&&t>=0);var e=t/26|0;var n=t%26;this._expand(e+1);(this||i).words[e]=r?(this||i).words[e]|1<<n:(this||i).words[e]&~(1<<n);return this._strip()};BN.prototype.iadd=function iadd(t){var r;if(0!==(this||i).negative&&0===t.negative){(this||i).negative=0;r=this.isub(t);(this||i).negative^=1;return this._normSign()}if(0===(this||i).negative&&0!==t.negative){t.negative=0;r=this.isub(t);t.negative=1;return r._normSign()}var e,n;if((this||i).length>t.length){e=this||i;n=t}else{e=t;n=this||i}var h=0;for(var s=0;s<n.length;s++){r=(0|e.words[s])+(0|n.words[s])+h;(this||i).words[s]=67108863&r;h=r>>>26}for(;0!==h&&s<e.length;s++){r=(0|e.words[s])+h;(this||i).words[s]=67108863&r;h=r>>>26}(this||i).length=e.length;if(0!==h){(this||i).words[(this||i).length]=h;(this||i).length++}else if(e!==(this||i))for(;s<e.length;s++)(this||i).words[s]=e.words[s];return this||i};BN.prototype.add=function add(t){var r;if(0!==t.negative&&0===(this||i).negative){t.negative=0;r=this.sub(t);t.negative^=1;return r}if(0===t.negative&&0!==(this||i).negative){(this||i).negative=0;r=t.sub(this||i);(this||i).negative=1;return r}return(this||i).length>t.length?this.clone().iadd(t):t.clone().iadd(this||i)};BN.prototype.isub=function isub(t){if(0!==t.negative){t.negative=0;var r=this.iadd(t);t.negative=1;return r._normSign()}if(0!==(this||i).negative){(this||i).negative=0;this.iadd(t);(this||i).negative=1;return this._normSign()}var e=this.cmp(t);if(0===e){(this||i).negative=0;(this||i).length=1;(this||i).words[0]=0;return this||i}var n,h;if(e>0){n=this||i;h=t}else{n=t;h=this||i}var s=0;for(var o=0;o<h.length;o++){r=(0|n.words[o])-(0|h.words[o])+s;s=r>>26;(this||i).words[o]=67108863&r}for(;0!==s&&o<n.length;o++){r=(0|n.words[o])+s;s=r>>26;(this||i).words[o]=67108863&r}if(0===s&&o<n.length&&n!==(this||i))for(;o<n.length;o++)(this||i).words[o]=n.words[o];(this||i).length=Math.max((this||i).length,o);n!==(this||i)&&((this||i).negative=1);return this._strip()};BN.prototype.sub=function sub(t){return this.clone().isub(t)};function smallMulTo(t,i,r){r.negative=i.negative^t.negative;var e=t.length+i.length|0;r.length=e;e=e-1|0;var n=0|t.words[0];var h=0|i.words[0];var s=n*h;var o=67108863&s;var a=s/67108864|0;r.words[0]=o;for(var u=1;u<e;u++){var l=a>>>26;var m=67108863&a;var f=Math.min(u,i.length-1);for(var d=Math.max(0,u-t.length+1);d<=f;d++){var v=u-d|0;n=0|t.words[v];h=0|i.words[d];s=n*h+m;l+=s/67108864|0;m=67108863&s}r.words[u]=0|m;a=0|l}0!==a?r.words[u]=0|a:r.length--;return r._strip()}var u=function comb10MulTo(t,i,r){var e=t.words;var n=i.words;var h=r.words;var s=0;var o;var a;var u;var l=0|e[0];var m=8191&l;var f=l>>>13;var d=0|e[1];var v=8191&d;var p=d>>>13;var M=0|e[2];var g=8191&M;var c=M>>>13;var w=0|e[3];var y=8191&w;var B=w>>>13;var N=0|e[4];var b=8191&N;var _=N>>>13;var R=0|e[5];var A=8191&R;var k=R>>>13;var x=0|e[6];var S=8191&x;var T=x>>>13;var q=0|e[7];var P=8191&q;var F=q>>>13;var L=0|e[8];var Z=8191&L;var I=L>>>13;var E=0|e[9];var z=8191&E;var K=E>>>13;var j=0|n[0];var O=8191&j;var H=j>>>13;var D=0|n[1];var U=8191&D;var C=D>>>13;var J=0|n[2];var G=8191&J;var Q=J>>>13;var V=0|n[3];var W=8191&V;var X=V>>>13;var Y=0|n[4];var $=8191&Y;var tt=Y>>>13;var it=0|n[5];var rt=8191&it;var et=it>>>13;var nt=0|n[6];var ht=8191&nt;var st=nt>>>13;var ot=0|n[7];var at=8191&ot;var ut=ot>>>13;var mt=0|n[8];var ft=8191&mt;var dt=mt>>>13;var vt=0|n[9];var pt=8191&vt;var Mt=vt>>>13;r.negative=t.negative^i.negative;r.length=19;o=Math.imul(m,O);a=Math.imul(m,H);a=a+Math.imul(f,O)|0;u=Math.imul(f,H);var ct=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(ct>>>26)|0;ct&=67108863;o=Math.imul(v,O);a=Math.imul(v,H);a=a+Math.imul(p,O)|0;u=Math.imul(p,H);o=o+Math.imul(m,U)|0;a=a+Math.imul(m,C)|0;a=a+Math.imul(f,U)|0;u=u+Math.imul(f,C)|0;var wt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(wt>>>26)|0;wt&=67108863;o=Math.imul(g,O);a=Math.imul(g,H);a=a+Math.imul(c,O)|0;u=Math.imul(c,H);o=o+Math.imul(v,U)|0;a=a+Math.imul(v,C)|0;a=a+Math.imul(p,U)|0;u=u+Math.imul(p,C)|0;o=o+Math.imul(m,G)|0;a=a+Math.imul(m,Q)|0;a=a+Math.imul(f,G)|0;u=u+Math.imul(f,Q)|0;var yt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(yt>>>26)|0;yt&=67108863;o=Math.imul(y,O);a=Math.imul(y,H);a=a+Math.imul(B,O)|0;u=Math.imul(B,H);o=o+Math.imul(g,U)|0;a=a+Math.imul(g,C)|0;a=a+Math.imul(c,U)|0;u=u+Math.imul(c,C)|0;o=o+Math.imul(v,G)|0;a=a+Math.imul(v,Q)|0;a=a+Math.imul(p,G)|0;u=u+Math.imul(p,Q)|0;o=o+Math.imul(m,W)|0;a=a+Math.imul(m,X)|0;a=a+Math.imul(f,W)|0;u=u+Math.imul(f,X)|0;var Bt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Bt>>>26)|0;Bt&=67108863;o=Math.imul(b,O);a=Math.imul(b,H);a=a+Math.imul(_,O)|0;u=Math.imul(_,H);o=o+Math.imul(y,U)|0;a=a+Math.imul(y,C)|0;a=a+Math.imul(B,U)|0;u=u+Math.imul(B,C)|0;o=o+Math.imul(g,G)|0;a=a+Math.imul(g,Q)|0;a=a+Math.imul(c,G)|0;u=u+Math.imul(c,Q)|0;o=o+Math.imul(v,W)|0;a=a+Math.imul(v,X)|0;a=a+Math.imul(p,W)|0;u=u+Math.imul(p,X)|0;o=o+Math.imul(m,$)|0;a=a+Math.imul(m,tt)|0;a=a+Math.imul(f,$)|0;u=u+Math.imul(f,tt)|0;var Nt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Nt>>>26)|0;Nt&=67108863;o=Math.imul(A,O);a=Math.imul(A,H);a=a+Math.imul(k,O)|0;u=Math.imul(k,H);o=o+Math.imul(b,U)|0;a=a+Math.imul(b,C)|0;a=a+Math.imul(_,U)|0;u=u+Math.imul(_,C)|0;o=o+Math.imul(y,G)|0;a=a+Math.imul(y,Q)|0;a=a+Math.imul(B,G)|0;u=u+Math.imul(B,Q)|0;o=o+Math.imul(g,W)|0;a=a+Math.imul(g,X)|0;a=a+Math.imul(c,W)|0;u=u+Math.imul(c,X)|0;o=o+Math.imul(v,$)|0;a=a+Math.imul(v,tt)|0;a=a+Math.imul(p,$)|0;u=u+Math.imul(p,tt)|0;o=o+Math.imul(m,rt)|0;a=a+Math.imul(m,et)|0;a=a+Math.imul(f,rt)|0;u=u+Math.imul(f,et)|0;var bt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(bt>>>26)|0;bt&=67108863;o=Math.imul(S,O);a=Math.imul(S,H);a=a+Math.imul(T,O)|0;u=Math.imul(T,H);o=o+Math.imul(A,U)|0;a=a+Math.imul(A,C)|0;a=a+Math.imul(k,U)|0;u=u+Math.imul(k,C)|0;o=o+Math.imul(b,G)|0;a=a+Math.imul(b,Q)|0;a=a+Math.imul(_,G)|0;u=u+Math.imul(_,Q)|0;o=o+Math.imul(y,W)|0;a=a+Math.imul(y,X)|0;a=a+Math.imul(B,W)|0;u=u+Math.imul(B,X)|0;o=o+Math.imul(g,$)|0;a=a+Math.imul(g,tt)|0;a=a+Math.imul(c,$)|0;u=u+Math.imul(c,tt)|0;o=o+Math.imul(v,rt)|0;a=a+Math.imul(v,et)|0;a=a+Math.imul(p,rt)|0;u=u+Math.imul(p,et)|0;o=o+Math.imul(m,ht)|0;a=a+Math.imul(m,st)|0;a=a+Math.imul(f,ht)|0;u=u+Math.imul(f,st)|0;var _t=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(_t>>>26)|0;_t&=67108863;o=Math.imul(P,O);a=Math.imul(P,H);a=a+Math.imul(F,O)|0;u=Math.imul(F,H);o=o+Math.imul(S,U)|0;a=a+Math.imul(S,C)|0;a=a+Math.imul(T,U)|0;u=u+Math.imul(T,C)|0;o=o+Math.imul(A,G)|0;a=a+Math.imul(A,Q)|0;a=a+Math.imul(k,G)|0;u=u+Math.imul(k,Q)|0;o=o+Math.imul(b,W)|0;a=a+Math.imul(b,X)|0;a=a+Math.imul(_,W)|0;u=u+Math.imul(_,X)|0;o=o+Math.imul(y,$)|0;a=a+Math.imul(y,tt)|0;a=a+Math.imul(B,$)|0;u=u+Math.imul(B,tt)|0;o=o+Math.imul(g,rt)|0;a=a+Math.imul(g,et)|0;a=a+Math.imul(c,rt)|0;u=u+Math.imul(c,et)|0;o=o+Math.imul(v,ht)|0;a=a+Math.imul(v,st)|0;a=a+Math.imul(p,ht)|0;u=u+Math.imul(p,st)|0;o=o+Math.imul(m,at)|0;a=a+Math.imul(m,ut)|0;a=a+Math.imul(f,at)|0;u=u+Math.imul(f,ut)|0;var Rt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Rt>>>26)|0;Rt&=67108863;o=Math.imul(Z,O);a=Math.imul(Z,H);a=a+Math.imul(I,O)|0;u=Math.imul(I,H);o=o+Math.imul(P,U)|0;a=a+Math.imul(P,C)|0;a=a+Math.imul(F,U)|0;u=u+Math.imul(F,C)|0;o=o+Math.imul(S,G)|0;a=a+Math.imul(S,Q)|0;a=a+Math.imul(T,G)|0;u=u+Math.imul(T,Q)|0;o=o+Math.imul(A,W)|0;a=a+Math.imul(A,X)|0;a=a+Math.imul(k,W)|0;u=u+Math.imul(k,X)|0;o=o+Math.imul(b,$)|0;a=a+Math.imul(b,tt)|0;a=a+Math.imul(_,$)|0;u=u+Math.imul(_,tt)|0;o=o+Math.imul(y,rt)|0;a=a+Math.imul(y,et)|0;a=a+Math.imul(B,rt)|0;u=u+Math.imul(B,et)|0;o=o+Math.imul(g,ht)|0;a=a+Math.imul(g,st)|0;a=a+Math.imul(c,ht)|0;u=u+Math.imul(c,st)|0;o=o+Math.imul(v,at)|0;a=a+Math.imul(v,ut)|0;a=a+Math.imul(p,at)|0;u=u+Math.imul(p,ut)|0;o=o+Math.imul(m,ft)|0;a=a+Math.imul(m,dt)|0;a=a+Math.imul(f,ft)|0;u=u+Math.imul(f,dt)|0;var At=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(At>>>26)|0;At&=67108863;o=Math.imul(z,O);a=Math.imul(z,H);a=a+Math.imul(K,O)|0;u=Math.imul(K,H);o=o+Math.imul(Z,U)|0;a=a+Math.imul(Z,C)|0;a=a+Math.imul(I,U)|0;u=u+Math.imul(I,C)|0;o=o+Math.imul(P,G)|0;a=a+Math.imul(P,Q)|0;a=a+Math.imul(F,G)|0;u=u+Math.imul(F,Q)|0;o=o+Math.imul(S,W)|0;a=a+Math.imul(S,X)|0;a=a+Math.imul(T,W)|0;u=u+Math.imul(T,X)|0;o=o+Math.imul(A,$)|0;a=a+Math.imul(A,tt)|0;a=a+Math.imul(k,$)|0;u=u+Math.imul(k,tt)|0;o=o+Math.imul(b,rt)|0;a=a+Math.imul(b,et)|0;a=a+Math.imul(_,rt)|0;u=u+Math.imul(_,et)|0;o=o+Math.imul(y,ht)|0;a=a+Math.imul(y,st)|0;a=a+Math.imul(B,ht)|0;u=u+Math.imul(B,st)|0;o=o+Math.imul(g,at)|0;a=a+Math.imul(g,ut)|0;a=a+Math.imul(c,at)|0;u=u+Math.imul(c,ut)|0;o=o+Math.imul(v,ft)|0;a=a+Math.imul(v,dt)|0;a=a+Math.imul(p,ft)|0;u=u+Math.imul(p,dt)|0;o=o+Math.imul(m,pt)|0;a=a+Math.imul(m,Mt)|0;a=a+Math.imul(f,pt)|0;u=u+Math.imul(f,Mt)|0;var kt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(kt>>>26)|0;kt&=67108863;o=Math.imul(z,U);a=Math.imul(z,C);a=a+Math.imul(K,U)|0;u=Math.imul(K,C);o=o+Math.imul(Z,G)|0;a=a+Math.imul(Z,Q)|0;a=a+Math.imul(I,G)|0;u=u+Math.imul(I,Q)|0;o=o+Math.imul(P,W)|0;a=a+Math.imul(P,X)|0;a=a+Math.imul(F,W)|0;u=u+Math.imul(F,X)|0;o=o+Math.imul(S,$)|0;a=a+Math.imul(S,tt)|0;a=a+Math.imul(T,$)|0;u=u+Math.imul(T,tt)|0;o=o+Math.imul(A,rt)|0;a=a+Math.imul(A,et)|0;a=a+Math.imul(k,rt)|0;u=u+Math.imul(k,et)|0;o=o+Math.imul(b,ht)|0;a=a+Math.imul(b,st)|0;a=a+Math.imul(_,ht)|0;u=u+Math.imul(_,st)|0;o=o+Math.imul(y,at)|0;a=a+Math.imul(y,ut)|0;a=a+Math.imul(B,at)|0;u=u+Math.imul(B,ut)|0;o=o+Math.imul(g,ft)|0;a=a+Math.imul(g,dt)|0;a=a+Math.imul(c,ft)|0;u=u+Math.imul(c,dt)|0;o=o+Math.imul(v,pt)|0;a=a+Math.imul(v,Mt)|0;a=a+Math.imul(p,pt)|0;u=u+Math.imul(p,Mt)|0;var xt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(xt>>>26)|0;xt&=67108863;o=Math.imul(z,G);a=Math.imul(z,Q);a=a+Math.imul(K,G)|0;u=Math.imul(K,Q);o=o+Math.imul(Z,W)|0;a=a+Math.imul(Z,X)|0;a=a+Math.imul(I,W)|0;u=u+Math.imul(I,X)|0;o=o+Math.imul(P,$)|0;a=a+Math.imul(P,tt)|0;a=a+Math.imul(F,$)|0;u=u+Math.imul(F,tt)|0;o=o+Math.imul(S,rt)|0;a=a+Math.imul(S,et)|0;a=a+Math.imul(T,rt)|0;u=u+Math.imul(T,et)|0;o=o+Math.imul(A,ht)|0;a=a+Math.imul(A,st)|0;a=a+Math.imul(k,ht)|0;u=u+Math.imul(k,st)|0;o=o+Math.imul(b,at)|0;a=a+Math.imul(b,ut)|0;a=a+Math.imul(_,at)|0;u=u+Math.imul(_,ut)|0;o=o+Math.imul(y,ft)|0;a=a+Math.imul(y,dt)|0;a=a+Math.imul(B,ft)|0;u=u+Math.imul(B,dt)|0;o=o+Math.imul(g,pt)|0;a=a+Math.imul(g,Mt)|0;a=a+Math.imul(c,pt)|0;u=u+Math.imul(c,Mt)|0;var St=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(St>>>26)|0;St&=67108863;o=Math.imul(z,W);a=Math.imul(z,X);a=a+Math.imul(K,W)|0;u=Math.imul(K,X);o=o+Math.imul(Z,$)|0;a=a+Math.imul(Z,tt)|0;a=a+Math.imul(I,$)|0;u=u+Math.imul(I,tt)|0;o=o+Math.imul(P,rt)|0;a=a+Math.imul(P,et)|0;a=a+Math.imul(F,rt)|0;u=u+Math.imul(F,et)|0;o=o+Math.imul(S,ht)|0;a=a+Math.imul(S,st)|0;a=a+Math.imul(T,ht)|0;u=u+Math.imul(T,st)|0;o=o+Math.imul(A,at)|0;a=a+Math.imul(A,ut)|0;a=a+Math.imul(k,at)|0;u=u+Math.imul(k,ut)|0;o=o+Math.imul(b,ft)|0;a=a+Math.imul(b,dt)|0;a=a+Math.imul(_,ft)|0;u=u+Math.imul(_,dt)|0;o=o+Math.imul(y,pt)|0;a=a+Math.imul(y,Mt)|0;a=a+Math.imul(B,pt)|0;u=u+Math.imul(B,Mt)|0;var Tt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Tt>>>26)|0;Tt&=67108863;o=Math.imul(z,$);a=Math.imul(z,tt);a=a+Math.imul(K,$)|0;u=Math.imul(K,tt);o=o+Math.imul(Z,rt)|0;a=a+Math.imul(Z,et)|0;a=a+Math.imul(I,rt)|0;u=u+Math.imul(I,et)|0;o=o+Math.imul(P,ht)|0;a=a+Math.imul(P,st)|0;a=a+Math.imul(F,ht)|0;u=u+Math.imul(F,st)|0;o=o+Math.imul(S,at)|0;a=a+Math.imul(S,ut)|0;a=a+Math.imul(T,at)|0;u=u+Math.imul(T,ut)|0;o=o+Math.imul(A,ft)|0;a=a+Math.imul(A,dt)|0;a=a+Math.imul(k,ft)|0;u=u+Math.imul(k,dt)|0;o=o+Math.imul(b,pt)|0;a=a+Math.imul(b,Mt)|0;a=a+Math.imul(_,pt)|0;u=u+Math.imul(_,Mt)|0;var qt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(qt>>>26)|0;qt&=67108863;o=Math.imul(z,rt);a=Math.imul(z,et);a=a+Math.imul(K,rt)|0;u=Math.imul(K,et);o=o+Math.imul(Z,ht)|0;a=a+Math.imul(Z,st)|0;a=a+Math.imul(I,ht)|0;u=u+Math.imul(I,st)|0;o=o+Math.imul(P,at)|0;a=a+Math.imul(P,ut)|0;a=a+Math.imul(F,at)|0;u=u+Math.imul(F,ut)|0;o=o+Math.imul(S,ft)|0;a=a+Math.imul(S,dt)|0;a=a+Math.imul(T,ft)|0;u=u+Math.imul(T,dt)|0;o=o+Math.imul(A,pt)|0;a=a+Math.imul(A,Mt)|0;a=a+Math.imul(k,pt)|0;u=u+Math.imul(k,Mt)|0;var Pt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Pt>>>26)|0;Pt&=67108863;o=Math.imul(z,ht);a=Math.imul(z,st);a=a+Math.imul(K,ht)|0;u=Math.imul(K,st);o=o+Math.imul(Z,at)|0;a=a+Math.imul(Z,ut)|0;a=a+Math.imul(I,at)|0;u=u+Math.imul(I,ut)|0;o=o+Math.imul(P,ft)|0;a=a+Math.imul(P,dt)|0;a=a+Math.imul(F,ft)|0;u=u+Math.imul(F,dt)|0;o=o+Math.imul(S,pt)|0;a=a+Math.imul(S,Mt)|0;a=a+Math.imul(T,pt)|0;u=u+Math.imul(T,Mt)|0;var Ft=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Ft>>>26)|0;Ft&=67108863;o=Math.imul(z,at);a=Math.imul(z,ut);a=a+Math.imul(K,at)|0;u=Math.imul(K,ut);o=o+Math.imul(Z,ft)|0;a=a+Math.imul(Z,dt)|0;a=a+Math.imul(I,ft)|0;u=u+Math.imul(I,dt)|0;o=o+Math.imul(P,pt)|0;a=a+Math.imul(P,Mt)|0;a=a+Math.imul(F,pt)|0;u=u+Math.imul(F,Mt)|0;var Lt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Lt>>>26)|0;Lt&=67108863;o=Math.imul(z,ft);a=Math.imul(z,dt);a=a+Math.imul(K,ft)|0;u=Math.imul(K,dt);o=o+Math.imul(Z,pt)|0;a=a+Math.imul(Z,Mt)|0;a=a+Math.imul(I,pt)|0;u=u+Math.imul(I,Mt)|0;var Zt=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(Zt>>>26)|0;Zt&=67108863;o=Math.imul(z,pt);a=Math.imul(z,Mt);a=a+Math.imul(K,pt)|0;u=Math.imul(K,Mt);var It=(s+o|0)+((8191&a)<<13)|0;s=(u+(a>>>13)|0)+(It>>>26)|0;It&=67108863;h[0]=ct;h[1]=wt;h[2]=yt;h[3]=Bt;h[4]=Nt;h[5]=bt;h[6]=_t;h[7]=Rt;h[8]=At;h[9]=kt;h[10]=xt;h[11]=St;h[12]=Tt;h[13]=qt;h[14]=Pt;h[15]=Ft;h[16]=Lt;h[17]=Zt;h[18]=It;if(0!==s){h[19]=s;r.length++}return r};Math.imul||(u=smallMulTo);function bigMulTo(t,i,r){r.negative=i.negative^t.negative;r.length=t.length+i.length;var e=0;var n=0;for(var h=0;h<r.length-1;h++){var s=n;n=0;var o=67108863&e;var a=Math.min(h,i.length-1);for(var u=Math.max(0,h-t.length+1);u<=a;u++){var l=h-u;var m=0|t.words[l];var f=0|i.words[u];var d=m*f;var v=67108863&d;s=s+(d/67108864|0)|0;v=v+o|0;o=67108863&v;s=s+(v>>>26)|0;n+=s>>>26;s&=67108863}r.words[h]=o;e=s;s=n}0!==e?r.words[h]=e:r.length--;return r._strip()}function jumboMulTo(t,i,r){return bigMulTo(t,i,r)}BN.prototype.mulTo=function mulTo(t,r){var e;var n=(this||i).length+t.length;e=10===(this||i).length&&10===t.length?u(this||i,t,r):n<63?smallMulTo(this||i,t,r):n<1024?bigMulTo(this||i,t,r):jumboMulTo(this||i,t,r);return e};function FFTM(t,r){(this||i).x=t;(this||i).y=r}FFTM.prototype.makeRBT=function makeRBT(t){var i=new Array(t);var r=BN.prototype._countBits(t)-1;for(var e=0;e<t;e++)i[e]=this.revBin(e,r,t);return i};FFTM.prototype.revBin=function revBin(t,i,r){if(0===t||t===r-1)return t;var e=0;for(var n=0;n<i;n++){e|=(1&t)<<i-n-1;t>>=1}return e};FFTM.prototype.permute=function permute(t,i,r,e,n,h){for(var s=0;s<h;s++){e[s]=i[t[s]];n[s]=r[t[s]]}};FFTM.prototype.transform=function transform(t,i,r,e,n,h){this.permute(h,t,i,r,e,n);for(var s=1;s<n;s<<=1){var o=s<<1;var a=Math.cos(2*Math.PI/o);var u=Math.sin(2*Math.PI/o);for(var l=0;l<n;l+=o){var m=a;var f=u;for(var d=0;d<s;d++){var v=r[l+d];var p=e[l+d];var M=r[l+d+s];var g=e[l+d+s];var c=m*M-f*g;g=m*g+f*M;M=c;r[l+d]=v+M;e[l+d]=p+g;r[l+d+s]=v-M;e[l+d+s]=p-g;if(d!==o){c=a*m-u*f;f=a*f+u*m;m=c}}}}};FFTM.prototype.guessLen13b=function guessLen13b(t,i){var r=1|Math.max(i,t);var e=1&r;var n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+e};FFTM.prototype.conjugate=function conjugate(t,i,r){if(!(r<=1))for(var e=0;e<r/2;e++){var n=t[e];t[e]=t[r-e-1];t[r-e-1]=n;n=i[e];i[e]=-i[r-e-1];i[r-e-1]=-n}};FFTM.prototype.normalize13b=function normalize13b(t,i){var r=0;for(var e=0;e<i/2;e++){var n=8192*Math.round(t[2*e+1]/i)+Math.round(t[2*e]/i)+r;t[e]=67108863&n;r=n<67108864?0:n/67108864|0}return t};FFTM.prototype.convert13b=function convert13b(t,i,r,e){var n=0;for(var h=0;h<i;h++){n+=0|t[h];r[2*h]=8191&n;n>>>=13;r[2*h+1]=8191&n;n>>>=13}for(h=2*i;h<e;++h)r[h]=0;assert(0===n);assert(0===(-8192&n))};FFTM.prototype.stub=function stub(t){var i=new Array(t);for(var r=0;r<t;r++)i[r]=0;return i};FFTM.prototype.mulp=function mulp(t,i,r){var e=2*this.guessLen13b(t.length,i.length);var n=this.makeRBT(e);var h=this.stub(e);var s=new Array(e);var o=new Array(e);var a=new Array(e);var u=new Array(e);var l=new Array(e);var m=new Array(e);var f=r.words;f.length=e;this.convert13b(t.words,t.length,s,e);this.convert13b(i.words,i.length,u,e);this.transform(s,h,o,a,e,n);this.transform(u,h,l,m,e,n);for(var d=0;d<e;d++){var v=o[d]*l[d]-a[d]*m[d];a[d]=o[d]*m[d]+a[d]*l[d];o[d]=v}this.conjugate(o,a,e);this.transform(o,a,f,h,e,n);this.conjugate(f,h,e);this.normalize13b(f,e);r.negative=t.negative^i.negative;r.length=t.length+i.length;return r._strip()};BN.prototype.mul=function mul(t){var r=new BN(null);r.words=new Array((this||i).length+t.length);return this.mulTo(t,r)};BN.prototype.mulf=function mulf(t){var r=new BN(null);r.words=new Array((this||i).length+t.length);return jumboMulTo(this||i,t,r)};BN.prototype.imul=function imul(t){return this.clone().mulTo(t,this||i)};BN.prototype.imuln=function imuln(t){var r=t<0;r&&(t=-t);assert("number"===typeof t);assert(t<67108864);var e=0;for(var n=0;n<(this||i).length;n++){var h=(0|(this||i).words[n])*t;var s=(67108863&h)+(67108863&e);e>>=26;e+=h/67108864|0;e+=s>>>26;(this||i).words[n]=67108863&s}if(0!==e){(this||i).words[n]=e;(this||i).length++}return r?this.ineg():this||i};BN.prototype.muln=function muln(t){return this.clone().imuln(t)};BN.prototype.sqr=function sqr(){return this.mul(this||i)};BN.prototype.isqr=function isqr(){return this.imul(this.clone())};BN.prototype.pow=function pow(t){var r=toBitArray(t);if(0===r.length)return new BN(1);var e=this||i;for(var n=0;n<r.length;n++,e=e.sqr())if(0!==r[n])break;if(++n<r.length)for(var h=e.sqr();n<r.length;n++,h=h.sqr())0!==r[n]&&(e=e.mul(h));return e};BN.prototype.iushln=function iushln(t){assert("number"===typeof t&&t>=0);var r=t%26;var e=(t-r)/26;var n=67108863>>>26-r<<26-r;var h;if(0!==r){var s=0;for(h=0;h<(this||i).length;h++){var o=(this||i).words[h]&n;var a=(0|(this||i).words[h])-o<<r;(this||i).words[h]=a|s;s=o>>>26-r}if(s){(this||i).words[h]=s;(this||i).length++}}if(0!==e){for(h=(this||i).length-1;h>=0;h--)(this||i).words[h+e]=(this||i).words[h];for(h=0;h<e;h++)(this||i).words[h]=0;(this||i).length+=e}return this._strip()};BN.prototype.ishln=function ishln(t){assert(0===(this||i).negative);return this.iushln(t)};BN.prototype.iushrn=function iushrn(t,r,e){assert("number"===typeof t&&t>=0);var n;n=r?(r-r%26)/26:0;var h=t%26;var s=Math.min((t-h)/26,(this||i).length);var o=67108863^67108863>>>h<<h;var a=e;n-=s;n=Math.max(0,n);if(a){for(var u=0;u<s;u++)a.words[u]=(this||i).words[u];a.length=s}if(0===s);else if((this||i).length>s){(this||i).length-=s;for(u=0;u<(this||i).length;u++)(this||i).words[u]=(this||i).words[u+s]}else{(this||i).words[0]=0;(this||i).length=1}var l=0;for(u=(this||i).length-1;u>=0&&(0!==l||u>=n);u--){var m=0|(this||i).words[u];(this||i).words[u]=l<<26-h|m>>>h;l=m&o}a&&0!==l&&(a.words[a.length++]=l);if(0===(this||i).length){(this||i).words[0]=0;(this||i).length=1}return this._strip()};BN.prototype.ishrn=function ishrn(t,r,e){assert(0===(this||i).negative);return this.iushrn(t,r,e)};BN.prototype.shln=function shln(t){return this.clone().ishln(t)};BN.prototype.ushln=function ushln(t){return this.clone().iushln(t)};BN.prototype.shrn=function shrn(t){return this.clone().ishrn(t)};BN.prototype.ushrn=function ushrn(t){return this.clone().iushrn(t)};BN.prototype.testn=function testn(t){assert("number"===typeof t&&t>=0);var r=t%26;var e=(t-r)/26;var n=1<<r;if((this||i).length<=e)return false;var h=(this||i).words[e];return!!(h&n)};BN.prototype.imaskn=function imaskn(t){assert("number"===typeof t&&t>=0);var r=t%26;var e=(t-r)/26;assert(0===(this||i).negative,"imaskn works only with positive numbers");if((this||i).length<=e)return this||i;0!==r&&e++;(this||i).length=Math.min(e,(this||i).length);if(0!==r){var n=67108863^67108863>>>r<<r;(this||i).words[(this||i).length-1]&=n}return this._strip()};BN.prototype.maskn=function maskn(t){return this.clone().imaskn(t)};BN.prototype.iaddn=function iaddn(t){assert("number"===typeof t);assert(t<67108864);if(t<0)return this.isubn(-t);if(0!==(this||i).negative){if(1===(this||i).length&&(0|(this||i).words[0])<=t){(this||i).words[0]=t-(0|(this||i).words[0]);(this||i).negative=0;return this||i}(this||i).negative=0;this.isubn(t);(this||i).negative=1;return this||i}return this._iaddn(t)};BN.prototype._iaddn=function _iaddn(t){(this||i).words[0]+=t;for(var r=0;r<(this||i).length&&(this||i).words[r]>=67108864;r++){(this||i).words[r]-=67108864;r===(this||i).length-1?(this||i).words[r+1]=1:(this||i).words[r+1]++}(this||i).length=Math.max((this||i).length,r+1);return this||i};BN.prototype.isubn=function isubn(t){assert("number"===typeof t);assert(t<67108864);if(t<0)return this.iaddn(-t);if(0!==(this||i).negative){(this||i).negative=0;this.iaddn(t);(this||i).negative=1;return this||i}(this||i).words[0]-=t;if(1===(this||i).length&&(this||i).words[0]<0){(this||i).words[0]=-(this||i).words[0];(this||i).negative=1}else for(var r=0;r<(this||i).length&&(this||i).words[r]<0;r++){(this||i).words[r]+=67108864;(this||i).words[r+1]-=1}return this._strip()};BN.prototype.addn=function addn(t){return this.clone().iaddn(t)};BN.prototype.subn=function subn(t){return this.clone().isubn(t)};BN.prototype.iabs=function iabs(){(this||i).negative=0;return this||i};BN.prototype.abs=function abs(){return this.clone().iabs()};BN.prototype._ishlnsubmul=function _ishlnsubmul(t,r,e){var n=t.length+e;var h;this._expand(n);var s;var o=0;for(h=0;h<t.length;h++){s=(0|(this||i).words[h+e])+o;var a=(0|t.words[h])*r;s-=67108863&a;o=(s>>26)-(a/67108864|0);(this||i).words[h+e]=67108863&s}for(;h<(this||i).length-e;h++){s=(0|(this||i).words[h+e])+o;o=s>>26;(this||i).words[h+e]=67108863&s}if(0===o)return this._strip();assert(-1===o);o=0;for(h=0;h<(this||i).length;h++){s=-(0|(this||i).words[h])+o;o=s>>26;(this||i).words[h]=67108863&s}(this||i).negative=1;return this._strip()};BN.prototype._wordDiv=function _wordDiv(t,r){var e=(this||i).length-t.length;var n=this.clone();var h=t;var s=0|h.words[h.length-1];var o=this._countBits(s);e=26-o;if(0!==e){h=h.ushln(e);n.iushln(e);s=0|h.words[h.length-1]}var a=n.length-h.length;var u;if("mod"!==r){u=new BN(null);u.length=a+1;u.words=new Array(u.length);for(var l=0;l<u.length;l++)u.words[l]=0}var m=n.clone()._ishlnsubmul(h,1,a);if(0===m.negative){n=m;u&&(u.words[a]=1)}for(var f=a-1;f>=0;f--){var d=67108864*(0|n.words[h.length+f])+(0|n.words[h.length+f-1]);d=Math.min(d/s|0,67108863);n._ishlnsubmul(h,d,f);while(0!==n.negative){d--;n.negative=0;n._ishlnsubmul(h,1,f);n.isZero()||(n.negative^=1)}u&&(u.words[f]=d)}u&&u._strip();n._strip();"div"!==r&&0!==e&&n.iushrn(e);return{div:u||null,mod:n}};BN.prototype.divmod=function divmod(t,r,e){assert(!t.isZero());if(this.isZero())return{div:new BN(0),mod:new BN(0)};var n,h,s;if(0!==(this||i).negative&&0===t.negative){s=this.neg().divmod(t,r);"mod"!==r&&(n=s.div.neg());if("div"!==r){h=s.mod.neg();e&&0!==h.negative&&h.iadd(t)}return{div:n,mod:h}}if(0===(this||i).negative&&0!==t.negative){s=this.divmod(t.neg(),r);"mod"!==r&&(n=s.div.neg());return{div:n,mod:s.mod}}if(0!==((this||i).negative&t.negative)){s=this.neg().divmod(t.neg(),r);if("div"!==r){h=s.mod.neg();e&&0!==h.negative&&h.isub(t)}return{div:s.div,mod:h}}return t.length>(this||i).length||this.cmp(t)<0?{div:new BN(0),mod:this||i}:1===t.length?"div"===r?{div:this.divn(t.words[0]),mod:null}:"mod"===r?{div:null,mod:new BN(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new BN(this.modrn(t.words[0]))}:this._wordDiv(t,r)};BN.prototype.div=function div(t){return this.divmod(t,"div",false).div};BN.prototype.mod=function mod(t){return this.divmod(t,"mod",false).mod};BN.prototype.umod=function umod(t){return this.divmod(t,"mod",true).mod};BN.prototype.divRound=function divRound(t){var i=this.divmod(t);if(i.mod.isZero())return i.div;var r=0!==i.div.negative?i.mod.isub(t):i.mod;var e=t.ushrn(1);var n=t.andln(1);var h=r.cmp(e);return h<0||1===n&&0===h?i.div:0!==i.div.negative?i.div.isubn(1):i.div.iaddn(1)};BN.prototype.modrn=function modrn(t){var r=t<0;r&&(t=-t);assert(t<=67108863);var e=(1<<26)%t;var n=0;for(var h=(this||i).length-1;h>=0;h--)n=(e*n+(0|(this||i).words[h]))%t;return r?-n:n};BN.prototype.modn=function modn(t){return this.modrn(t)};BN.prototype.idivn=function idivn(t){var r=t<0;r&&(t=-t);assert(t<=67108863);var e=0;for(var n=(this||i).length-1;n>=0;n--){var h=(0|(this||i).words[n])+67108864*e;(this||i).words[n]=h/t|0;e=h%t}this._strip();return r?this.ineg():this||i};BN.prototype.divn=function divn(t){return this.clone().idivn(t)};BN.prototype.egcd=function egcd(t){assert(0===t.negative);assert(!t.isZero());var r=this||i;var e=t.clone();r=0!==r.negative?r.umod(t):r.clone();var n=new BN(1);var h=new BN(0);var s=new BN(0);var o=new BN(1);var a=0;while(r.isEven()&&e.isEven()){r.iushrn(1);e.iushrn(1);++a}var u=e.clone();var l=r.clone();while(!r.isZero()){for(var m=0,f=1;0===(r.words[0]&f)&&m<26;++m,f<<=1);if(m>0){r.iushrn(m);while(m-- >0){if(n.isOdd()||h.isOdd()){n.iadd(u);h.isub(l)}n.iushrn(1);h.iushrn(1)}}for(var d=0,v=1;0===(e.words[0]&v)&&d<26;++d,v<<=1);if(d>0){e.iushrn(d);while(d-- >0){if(s.isOdd()||o.isOdd()){s.iadd(u);o.isub(l)}s.iushrn(1);o.iushrn(1)}}if(r.cmp(e)>=0){r.isub(e);n.isub(s);h.isub(o)}else{e.isub(r);s.isub(n);o.isub(h)}}return{a:s,b:o,gcd:e.iushln(a)}};BN.prototype._invmp=function _invmp(t){assert(0===t.negative);assert(!t.isZero());var r=this||i;var e=t.clone();r=0!==r.negative?r.umod(t):r.clone();var n=new BN(1);var h=new BN(0);var s=e.clone();while(r.cmpn(1)>0&&e.cmpn(1)>0){for(var o=0,a=1;0===(r.words[0]&a)&&o<26;++o,a<<=1);if(o>0){r.iushrn(o);while(o-- >0){n.isOdd()&&n.iadd(s);n.iushrn(1)}}for(var u=0,l=1;0===(e.words[0]&l)&&u<26;++u,l<<=1);if(u>0){e.iushrn(u);while(u-- >0){h.isOdd()&&h.iadd(s);h.iushrn(1)}}if(r.cmp(e)>=0){r.isub(e);n.isub(h)}else{e.isub(r);h.isub(n)}}var m;m=0===r.cmpn(1)?n:h;m.cmpn(0)<0&&m.iadd(t);return m};BN.prototype.gcd=function gcd(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var i=this.clone();var r=t.clone();i.negative=0;r.negative=0;for(var e=0;i.isEven()&&r.isEven();e++){i.iushrn(1);r.iushrn(1)}do{while(i.isEven())i.iushrn(1);while(r.isEven())r.iushrn(1);var n=i.cmp(r);if(n<0){var h=i;i=r;r=h}else if(0===n||0===r.cmpn(1))break;i.isub(r)}while(true);return r.iushln(e)};BN.prototype.invm=function invm(t){return this.egcd(t).a.umod(t)};BN.prototype.isEven=function isEven(){return 0===(1&(this||i).words[0])};BN.prototype.isOdd=function isOdd(){return 1===(1&(this||i).words[0])};BN.prototype.andln=function andln(t){return(this||i).words[0]&t};BN.prototype.bincn=function bincn(t){assert("number"===typeof t);var r=t%26;var e=(t-r)/26;var n=1<<r;if((this||i).length<=e){this._expand(e+1);(this||i).words[e]|=n;return this||i}var h=n;for(var s=e;0!==h&&s<(this||i).length;s++){var o=0|(this||i).words[s];o+=h;h=o>>>26;o&=67108863;(this||i).words[s]=o}if(0!==h){(this||i).words[s]=h;(this||i).length++}return this||i};BN.prototype.isZero=function isZero(){return 1===(this||i).length&&0===(this||i).words[0]};BN.prototype.cmpn=function cmpn(t){var r=t<0;if(0!==(this||i).negative&&!r)return-1;if(0===(this||i).negative&&r)return 1;this._strip();var e;if((this||i).length>1)e=1;else{r&&(t=-t);assert(t<=67108863,"Number is too big");var n=0|(this||i).words[0];e=n===t?0:n<t?-1:1}return 0!==(this||i).negative?0|-e:e};BN.prototype.cmp=function cmp(t){if(0!==(this||i).negative&&0===t.negative)return-1;if(0===(this||i).negative&&0!==t.negative)return 1;var r=this.ucmp(t);return 0!==(this||i).negative?0|-r:r};BN.prototype.ucmp=function ucmp(t){if((this||i).length>t.length)return 1;if((this||i).length<t.length)return-1;var r=0;for(var e=(this||i).length-1;e>=0;e--){var n=0|(this||i).words[e];var h=0|t.words[e];if(n!==h){n<h?r=-1:n>h&&(r=1);break}}return r};BN.prototype.gtn=function gtn(t){return 1===this.cmpn(t)};BN.prototype.gt=function gt(t){return 1===this.cmp(t)};BN.prototype.gten=function gten(t){return this.cmpn(t)>=0};BN.prototype.gte=function gte(t){return this.cmp(t)>=0};BN.prototype.ltn=function ltn(t){return-1===this.cmpn(t)};BN.prototype.lt=function lt(t){return-1===this.cmp(t)};BN.prototype.lten=function lten(t){return this.cmpn(t)<=0};BN.prototype.lte=function lte(t){return this.cmp(t)<=0};BN.prototype.eqn=function eqn(t){return 0===this.cmpn(t)};BN.prototype.eq=function eq(t){return 0===this.cmp(t)};BN.red=function red(t){return new Red(t)};BN.prototype.toRed=function toRed(t){assert(!(this||i).red,"Already a number in reduction context");assert(0===(this||i).negative,"red works only with positives");return t.convertTo(this||i)._forceRed(t)};BN.prototype.fromRed=function fromRed(){assert((this||i).red,"fromRed works only with numbers in reduction context");return(this||i).red.convertFrom(this||i)};BN.prototype._forceRed=function _forceRed(t){(this||i).red=t;return this||i};BN.prototype.forceRed=function forceRed(t){assert(!(this||i).red,"Already a number in reduction context");return this._forceRed(t)};BN.prototype.redAdd=function redAdd(t){assert((this||i).red,"redAdd works only with red numbers");return(this||i).red.add(this||i,t)};BN.prototype.redIAdd=function redIAdd(t){assert((this||i).red,"redIAdd works only with red numbers");return(this||i).red.iadd(this||i,t)};BN.prototype.redSub=function redSub(t){assert((this||i).red,"redSub works only with red numbers");return(this||i).red.sub(this||i,t)};BN.prototype.redISub=function redISub(t){assert((this||i).red,"redISub works only with red numbers");return(this||i).red.isub(this||i,t)};BN.prototype.redShl=function redShl(t){assert((this||i).red,"redShl works only with red numbers");return(this||i).red.shl(this||i,t)};BN.prototype.redMul=function redMul(t){assert((this||i).red,"redMul works only with red numbers");(this||i).red._verify2(this||i,t);return(this||i).red.mul(this||i,t)};BN.prototype.redIMul=function redIMul(t){assert((this||i).red,"redMul works only with red numbers");(this||i).red._verify2(this||i,t);return(this||i).red.imul(this||i,t)};BN.prototype.redSqr=function redSqr(){assert((this||i).red,"redSqr works only with red numbers");(this||i).red._verify1(this||i);return(this||i).red.sqr(this||i)};BN.prototype.redISqr=function redISqr(){assert((this||i).red,"redISqr works only with red numbers");(this||i).red._verify1(this||i);return(this||i).red.isqr(this||i)};BN.prototype.redSqrt=function redSqrt(){assert((this||i).red,"redSqrt works only with red numbers");(this||i).red._verify1(this||i);return(this||i).red.sqrt(this||i)};BN.prototype.redInvm=function redInvm(){assert((this||i).red,"redInvm works only with red numbers");(this||i).red._verify1(this||i);return(this||i).red.invm(this||i)};BN.prototype.redNeg=function redNeg(){assert((this||i).red,"redNeg works only with red numbers");(this||i).red._verify1(this||i);return(this||i).red.neg(this||i)};BN.prototype.redPow=function redPow(t){assert((this||i).red&&!t.red,"redPow(normalNum)");(this||i).red._verify1(this||i);return(this||i).red.pow(this||i,t)};var l={k256:null,p224:null,p192:null,p25519:null};function MPrime(t,r){(this||i).name=t;(this||i).p=new BN(r,16);(this||i).n=(this||i).p.bitLength();(this||i).k=new BN(1).iushln((this||i).n).isub((this||i).p);(this||i).tmp=this._tmp()}MPrime.prototype._tmp=function _tmp(){var t=new BN(null);t.words=new Array(Math.ceil((this||i).n/13));return t};MPrime.prototype.ireduce=function ireduce(t){var r=t;var e;do{this.split(r,(this||i).tmp);r=this.imulK(r);r=r.iadd((this||i).tmp);e=r.bitLength()}while(e>(this||i).n);var n=e<(this||i).n?-1:r.ucmp((this||i).p);if(0===n){r.words[0]=0;r.length=1}else n>0?r.isub((this||i).p):void 0!==r.strip?r.strip():r._strip();return r};MPrime.prototype.split=function split(t,r){t.iushrn((this||i).n,0,r)};MPrime.prototype.imulK=function imulK(t){return t.imul((this||i).k)};function K256(){MPrime.call(this||i,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}inherits(K256,MPrime);K256.prototype.split=function split(t,i){var r=4194303;var e=Math.min(t.length,9);for(var n=0;n<e;n++)i.words[n]=t.words[n];i.length=e;if(t.length<=9){t.words[0]=0;t.length=1}else{var h=t.words[9];i.words[i.length++]=h&r;for(n=10;n<t.length;n++){var s=0|t.words[n];t.words[n-10]=(s&r)<<4|h>>>22;h=s}h>>>=22;t.words[n-10]=h;0===h&&t.length>10?t.length-=10:t.length-=9}};K256.prototype.imulK=function imulK(t){t.words[t.length]=0;t.words[t.length+1]=0;t.length+=2;var i=0;for(var r=0;r<t.length;r++){var e=0|t.words[r];i+=977*e;t.words[r]=67108863&i;i=64*e+(i/67108864|0)}if(0===t.words[t.length-1]){t.length--;0===t.words[t.length-1]&&t.length--}return t};function P224(){MPrime.call(this||i,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}inherits(P224,MPrime);function P192(){MPrime.call(this||i,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}inherits(P192,MPrime);function P25519(){MPrime.call(this||i,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}inherits(P25519,MPrime);P25519.prototype.imulK=function imulK(t){var i=0;for(var r=0;r<t.length;r++){var e=19*(0|t.words[r])+i;var n=67108863&e;e>>>=26;t.words[r]=n;i=e}0!==i&&(t.words[t.length++]=i);return t};BN._prime=function prime(t){if(l[t])return l[t];var prime;if("k256"===t)prime=new K256;else if("p224"===t)prime=new P224;else if("p192"===t)prime=new P192;else{if("p25519"!==t)throw new Error("Unknown prime "+t);prime=new P25519}l[t]=prime;return prime};function Red(t){if("string"===typeof t){var r=BN._prime(t);(this||i).m=r.p;(this||i).prime=r}else{assert(t.gtn(1),"modulus must be greater than 1");(this||i).m=t;(this||i).prime=null}}Red.prototype._verify1=function _verify1(t){assert(0===t.negative,"red works only with positives");assert(t.red,"red works only with red numbers")};Red.prototype._verify2=function _verify2(t,i){assert(0===(t.negative|i.negative),"red works only with positives");assert(t.red&&t.red===i.red,"red works only with red numbers")};Red.prototype.imod=function imod(t){if((this||i).prime)return(this||i).prime.ireduce(t)._forceRed(this||i);move(t,t.umod((this||i).m)._forceRed(this||i));return t};Red.prototype.neg=function neg(t){return t.isZero()?t.clone():(this||i).m.sub(t)._forceRed(this||i)};Red.prototype.add=function add(t,r){this._verify2(t,r);var e=t.add(r);e.cmp((this||i).m)>=0&&e.isub((this||i).m);return e._forceRed(this||i)};Red.prototype.iadd=function iadd(t,r){this._verify2(t,r);var e=t.iadd(r);e.cmp((this||i).m)>=0&&e.isub((this||i).m);return e};Red.prototype.sub=function sub(t,r){this._verify2(t,r);var e=t.sub(r);e.cmpn(0)<0&&e.iadd((this||i).m);return e._forceRed(this||i)};Red.prototype.isub=function isub(t,r){this._verify2(t,r);var e=t.isub(r);e.cmpn(0)<0&&e.iadd((this||i).m);return e};Red.prototype.shl=function shl(t,i){this._verify1(t);return this.imod(t.ushln(i))};Red.prototype.imul=function imul(t,i){this._verify2(t,i);return this.imod(t.imul(i))};Red.prototype.mul=function mul(t,i){this._verify2(t,i);return this.imod(t.mul(i))};Red.prototype.isqr=function isqr(t){return this.imul(t,t.clone())};Red.prototype.sqr=function sqr(t){return this.mul(t,t)};Red.prototype.sqrt=function sqrt(t){if(t.isZero())return t.clone();var r=(this||i).m.andln(3);assert(r%2===1);if(3===r){var e=(this||i).m.add(new BN(1)).iushrn(2);return this.pow(t,e)}var n=(this||i).m.subn(1);var h=0;while(!n.isZero()&&0===n.andln(1)){h++;n.iushrn(1)}assert(!n.isZero());var s=new BN(1).toRed(this||i);var o=s.redNeg();var a=(this||i).m.subn(1).iushrn(1);var u=(this||i).m.bitLength();u=new BN(2*u*u).toRed(this||i);while(0!==this.pow(u,a).cmp(o))u.redIAdd(o);var l=this.pow(u,n);var m=this.pow(t,n.addn(1).iushrn(1));var f=this.pow(t,n);var d=h;while(0!==f.cmp(s)){var v=f;for(var p=0;0!==v.cmp(s);p++)v=v.redSqr();assert(p<d);var M=this.pow(l,new BN(1).iushln(d-p-1));m=m.redMul(M);l=M.redSqr();f=f.redMul(l);d=p}return m};Red.prototype.invm=function invm(t){var r=t._invmp((this||i).m);if(0!==r.negative){r.negative=0;return this.imod(r).redNeg()}return this.imod(r)};Red.prototype.pow=function pow(t,r){if(r.isZero())return new BN(1).toRed(this||i);if(0===r.cmpn(1))return t.clone();var e=4;var n=new Array(1<<e);n[0]=new BN(1).toRed(this||i);n[1]=t;for(var h=2;h<n.length;h++)n[h]=this.mul(n[h-1],t);var s=n[0];var o=0;var a=0;var u=r.bitLength()%26;0===u&&(u=26);for(h=r.length-1;h>=0;h--){var l=r.words[h];for(var m=u-1;m>=0;m--){var f=l>>m&1;s!==n[0]&&(s=this.sqr(s));if(0!==f||0!==o){o<<=1;o|=f;a++;if(a===e||0===h&&0===m){s=this.mul(s,n[o]);a=0;o=0}}else a=0}u=26}return s};Red.prototype.convertTo=function convertTo(t){var r=t.umod((this||i).m);return r===t?r.clone():r};Red.prototype.convertFrom=function convertFrom(t){var i=t.clone();i.red=null;return i};BN.mont=function mont(t){return new Mont(t)};function Mont(t){Red.call(this||i,t);(this||i).shift=(this||i).m.bitLength();(this||i).shift%26!==0&&((this||i).shift+=26-(this||i).shift%26);(this||i).r=new BN(1).iushln((this||i).shift);(this||i).r2=this.imod((this||i).r.sqr());(this||i).rinv=(this||i).r._invmp((this||i).m);(this||i).minv=(this||i).rinv.mul((this||i).r).isubn(1).div((this||i).m);(this||i).minv=(this||i).minv.umod((this||i).r);(this||i).minv=(this||i).r.sub((this||i).minv)}inherits(Mont,Red);Mont.prototype.convertTo=function convertTo(t){return this.imod(t.ushln((this||i).shift))};Mont.prototype.convertFrom=function convertFrom(t){var r=this.imod(t.mul((this||i).rinv));r.red=null;return r};Mont.prototype.imul=function imul(t,r){if(t.isZero()||r.isZero()){t.words[0]=0;t.length=1;return t}var e=t.imul(r);var n=e.maskn((this||i).shift).mul((this||i).minv).imaskn((this||i).shift).mul((this||i).m);var h=e.isub(n).iushrn((this||i).shift);var s=h;h.cmp((this||i).m)>=0?s=h.isub((this||i).m):h.cmpn(0)<0&&(s=h.iadd((this||i).m));return s._forceRed(this||i)};Mont.prototype.mul=function mul(t,r){if(t.isZero()||r.isZero())return new BN(0)._forceRed(this||i);var e=t.mul(r);var n=e.maskn((this||i).shift).mul((this||i).minv).imaskn((this||i).shift).mul((this||i).m);var h=e.isub(n).iushrn((this||i).shift);var s=h;h.cmp((this||i).m)>=0?s=h.isub((this||i).m):h.cmpn(0)<0&&(s=h.iadd((this||i).m));return s._forceRed(this||i)};Mont.prototype.invm=function invm(t){var r=this.imod(t._invmp((this||i).m).mul((this||i).r2));return r._forceRed(this||i)}})(e,r);var n=e.exports;const h=e.exports.BN;export default n;export{h as BN};

