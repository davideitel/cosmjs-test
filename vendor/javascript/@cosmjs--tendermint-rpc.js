import*as e from"@cosmjs/crypto";import*as t from"@cosmjs/encoding";import*as r from"@cosmjs/math";import*as o from"@cosmjs/json-rpc";import*as s from"axios";import n from"./rpcclients/rpcclient.js";import*as a from"@cosmjs/socket";import*as c from"@cosmjs/stream";import*as i from"xstream";import*as d from"@cosmjs/utils";var u="default"in e?e.default:e;var l="default"in t?t.default:t;var p={};Object.defineProperty(p,"__esModule",{value:true});p.pubkeyToAddress=p.pubkeyToRawAddress=p.rawSecp256k1PubkeyToRawAddress=p.rawEd25519PubkeyToRawAddress=void 0;const h=u;const m=l;function rawEd25519PubkeyToRawAddress$1(e){if(32!==e.length)throw new Error(`Invalid Ed25519 pubkey length: ${e.length}`);return(0,h.sha256)(e).slice(0,20)}p.rawEd25519PubkeyToRawAddress=rawEd25519PubkeyToRawAddress$1;function rawSecp256k1PubkeyToRawAddress$1(e){if(33!==e.length)throw new Error(`Invalid Secp256k1 pubkey length (compressed): ${e.length}`);return(0,h.ripemd160)((0,h.sha256)(e))}p.rawSecp256k1PubkeyToRawAddress=rawSecp256k1PubkeyToRawAddress$1;function pubkeyToRawAddress$1(e,t){switch(e){case"ed25519":return rawEd25519PubkeyToRawAddress$1(t);case"secp256k1":return rawSecp256k1PubkeyToRawAddress$1(t);default:throw new Error(`Pubkey type ${e} not supported`)}}p.pubkeyToRawAddress=pubkeyToRawAddress$1;function pubkeyToAddress$1(e,t){return(0,m.toHex)(pubkeyToRawAddress$1(e,t)).toUpperCase()}p.pubkeyToAddress=pubkeyToAddress$1;var f="default"in t?t.default:t;var y="default"in r?r.default:r;var b={};Object.defineProperty(b,"__esModule",{value:true});b.DateTime=b.toSeconds=b.fromSeconds=b.toRfc3339WithNanoseconds=b.fromRfc3339WithNanoseconds=void 0;const g=f;const k=y;function fromRfc3339WithNanoseconds$1(e){const t=(0,g.fromRfc3339)(e);const r=e.match(/\.(\d+)Z$/);const o=r?r[1].slice(3):"";t.nanoseconds=parseInt(o.padEnd(6,"0"),10);return t}b.fromRfc3339WithNanoseconds=fromRfc3339WithNanoseconds$1;function toRfc3339WithNanoseconds$1(e){var t,r;const o=e.toISOString();const s=null!==(r=null===(t=e.nanoseconds)||void 0===t?void 0:t.toString())&&void 0!==r?r:"";return`${o.slice(0,-1)}${s.padStart(6,"0")}Z`}b.toRfc3339WithNanoseconds=toRfc3339WithNanoseconds$1;function fromSeconds$1(e,t=0){const r=new k.Uint32(t).toNumber();if(r>999999999)throw new Error("Nano seconds must not exceed 999999999");const o=new Date(1e3*e+Math.floor(r/1e6));o.nanoseconds=r%1e6;return o}b.fromSeconds=fromSeconds$1;function toSeconds$1(e){var t;return{seconds:Math.floor(e.getTime()/1e3),nanos:e.getTime()%1e3*1e6+(null!==(t=e.nanoseconds)&&void 0!==t?t:0)}}b.toSeconds=toSeconds$1;
/** @deprecated Use fromRfc3339WithNanoseconds/toRfc3339WithNanoseconds instead */class DateTime$1{
/** @deprecated Use fromRfc3339WithNanoseconds instead */
static decode(e){return fromRfc3339WithNanoseconds$1(e)}
/** @deprecated Use toRfc3339WithNanoseconds instead */static encode(e){return toRfc3339WithNanoseconds$1(e)}}b.DateTime=DateTime$1;var v="default"in o?o.default:o;var S="default"in s?s.default:s;var T={};var x=T&&T.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(T,"__esModule",{value:true});T.HttpClient=T.http=void 0;const w=v;const _=x(S);const B=n;function filterBadStatus(e){if(e.status>=400)throw new Error(`Bad status on response: ${e.status}`);return e}async function http(e,t,r,o){if("undefined"!==typeof fetch){const s={method:e,body:o?JSON.stringify(o):void 0,headers:{"Content-Type":"application/json",...r}};return fetch(t,s).then(filterBadStatus).then((e=>e.json()))}return _.default.request({url:t,method:e,data:o,headers:r}).then((e=>e.data))}T.http=http;class HttpClient$1{constructor(e){if("string"===typeof e)this.url=(0,B.hasProtocol)(e)?e:"http://"+e;else{this.url=e.url;this.headers=e.headers}}disconnect(){}async execute(e){const t=(0,w.parseJsonRpcResponse)(await http("POST",this.url,this.headers,e));if((0,w.isJsonRpcErrorResponse)(t))throw new Error(JSON.stringify(t.error));return t}}T.HttpClient=HttpClient$1;var R="default"in o?o.default:o;var E="default"in a?a.default:a;var P="default"in c?c.default:c;var I="default"in i?i.default:i;var N={};Object.defineProperty(N,"__esModule",{value:true});N.WebsocketClient=void 0;const C=R;const A=E;const j=P;const O=I;const H=n;function defaultErrorHandler(e){throw e}function toJsonRpcResponse(e){if("message"!==e.type)throw new Error(`Unexcepted message type on websocket: ${e.type}`);const t=(0,C.parseJsonRpcResponse)(JSON.parse(e.data));return t}class RpcEventProducer{constructor(e,t){this.running=false;this.subscriptions=[];this.request=e;this.socket=t}start(e){if(this.running)throw Error("Already started. Please stop first before restarting.");this.running=true;this.connectToClient(e);this.socket.queueRequest(JSON.stringify(this.request))}stop(){this.running=false;const e={...this.request,method:"unsubscribe"};try{this.socket.queueRequest(JSON.stringify(e))}catch(e){if(!(e instanceof Error&&e.message.match(/socket has disconnected/i)))throw e}}connectToClient(e){const t=this.socket.events.map(toJsonRpcResponse);const r=t.filter((e=>e.id===this.request.id)).subscribe({next:t=>{if((0,C.isJsonRpcErrorResponse)(t)){this.closeSubscriptions();e.error(JSON.stringify(t.error))}r.unsubscribe()}});const o=t.filter((e=>e.id===this.request.id)).subscribe({next:t=>{if((0,C.isJsonRpcErrorResponse)(t)){this.closeSubscriptions();e.error(JSON.stringify(t.error))}else e.next(t.result)}});const s=t.subscribe({error:t=>{this.closeSubscriptions();e.error(t)},complete:()=>{this.closeSubscriptions();e.complete()}});this.subscriptions.push(r,o,s)}closeSubscriptions(){for(const e of this.subscriptions)e.unsubscribe();this.subscriptions=[]}}class WebsocketClient$1{constructor(e,t=defaultErrorHandler){this.subscriptionStreams=new Map;const r=e.endsWith("/")?"websocket":"/websocket";const o=(0,H.hasProtocol)(e)?e:"ws://"+e;this.url=o+r;this.socket=new A.ReconnectingSocket(this.url);const s=this.socket.events.subscribe({error:e=>{t(e);s.unsubscribe()}});this.jsonRpcResponseStream=this.socket.events.map(toJsonRpcResponse);this.socket.connect()}async execute(e){const t=this.responseForRequestId(e.id);this.socket.queueRequest(JSON.stringify(e));const r=await t;if((0,C.isJsonRpcErrorResponse)(r))throw new Error(JSON.stringify(r.error));return r}listen(e){if("subscribe"!==e.method)throw new Error('Request method must be "subscribe" to start event listening');const t=e.params.query;if("string"!==typeof t)throw new Error("request.params.query must be a string");if(!this.subscriptionStreams.has(t)){const r=new RpcEventProducer(e,this.socket);const o=O.Stream.create(r);this.subscriptionStreams.set(t,o)}return this.subscriptionStreams.get(t).filter((e=>void 0!==e.query))}async connected(){await this.socket.connectionStatus.waitFor(A.ConnectionStatus.Connected)}disconnect(){this.socket.disconnect()}async responseForRequestId(e){return(0,j.firstEvent)(this.jsonRpcResponseStream.filter((t=>t.id===e)))}}N.WebsocketClient=WebsocketClient$1;var M={};Object.defineProperty(M,"__esModule",{value:true});M.WebsocketClient=M.instanceOfRpcStreamingClient=M.HttpClient=void 0;var q=T;Object.defineProperty(M,"HttpClient",{enumerable:true,get:function(){return q.HttpClient}});var V=n;Object.defineProperty(M,"instanceOfRpcStreamingClient",{enumerable:true,get:function(){return V.instanceOfRpcStreamingClient}});var $=N;Object.defineProperty(M,"WebsocketClient",{enumerable:true,get:function(){return $.WebsocketClient}});var W={};
/* eslint-disable @typescript-eslint/naming-convention */Object.defineProperty(W,"__esModule",{value:true});W.buildQuery=W.SubscriptionEventType=W.Method=void 0;(function(e){e.AbciInfo="abci_info";e.AbciQuery="abci_query";e.Block="block";e.Blockchain="blockchain";e.BlockResults="block_results";e.BlockSearch="block_search";e.BroadcastTxAsync="broadcast_tx_async";e.BroadcastTxSync="broadcast_tx_sync";e.BroadcastTxCommit="broadcast_tx_commit";e.Commit="commit";e.Genesis="genesis";e.Health="health";e.Status="status";e.Subscribe="subscribe";e.Tx="tx";e.TxSearch="tx_search";e.Validators="validators";e.Unsubscribe="unsubscribe"})(W.Method||(W.Method={}));(function(e){e.NewBlock="NewBlock";e.NewBlockHeader="NewBlockHeader";e.Tx="Tx"})(W.SubscriptionEventType||(W.SubscriptionEventType={}));function buildQuery(e){const t=e.tags?e.tags:[];const r=t.map((e=>`${e.key}='${e.value}'`));const o=e.raw?[e.raw]:[];return[...r,...o].join(" AND ")}W.buildQuery=buildQuery;var J={};Object.defineProperty(J,"__esModule",{value:true});J.VoteType=J.broadcastTxCommitSuccess=J.broadcastTxSyncSuccess=void 0;function broadcastTxSyncSuccess$1(e){return 0===e.code}J.broadcastTxSyncSuccess=broadcastTxSyncSuccess$1;function broadcastTxCommitSuccess$1(e){return 0===e.checkTx.code&&!!e.deliverTx&&0===e.deliverTx.code}J.broadcastTxCommitSuccess=broadcastTxCommitSuccess$1;(function(e){e[e.PreVote=1]="PreVote";e[e.PreCommit=2]="PreCommit"})(J.VoteType||(J.VoteType={}));var U={};Object.defineProperty(U,"__esModule",{value:true});U.createJsonRpcRequest=void 0;const D="123456789";function randomNumericChar(){return D[Math.floor(Math.random()*D.length)]}function randomId(){return parseInt(Array.from({length:12}).map((()=>randomNumericChar())).join(""),10)}function createJsonRpcRequest(e,t){const r=t?{...t}:{};return{jsonrpc:"2.0",id:randomId(),method:e,params:r}}U.createJsonRpcRequest=createJsonRpcRequest;var Q="default"in t?t.default:t;var F="default"in r?r.default:r;var G={};Object.defineProperty(G,"__esModule",{value:true});G.encodeBlockId=G.encodeVersion=G.encodeBytes=G.encodeTime=G.encodeInt=G.encodeString=G.Integer=G.dictionaryToStringMap=G.may=G.optional=G.assertNotEmpty=G.assertObject=G.assertArray=G.assertNumber=G.assertString=G.assertBoolean=G.assertSet=void 0;const z=Q;const K=F;function assertSet(e){if(void 0===e)throw new Error("Value must not be undefined");if(null===e)throw new Error("Value must not be null");return e}G.assertSet=assertSet;function assertBoolean(e){assertSet(e);if("boolean"!==typeof e)throw new Error("Value must be a boolean");return e}G.assertBoolean=assertBoolean;function assertString(e){assertSet(e);if("string"!==typeof e)throw new Error("Value must be a string");return e}G.assertString=assertString;function assertNumber(e){assertSet(e);if("number"!==typeof e)throw new Error("Value must be a number");return e}G.assertNumber=assertNumber;function assertArray(e){assertSet(e);if(!Array.isArray(e))throw new Error("Value must be a an array");return e}G.assertArray=assertArray;function assertObject(e){assertSet(e);if("object"!==typeof e)throw new Error("Value must be an object");if("[object Object]"!==Object.prototype.toString.call(e))throw new Error("Value must be a simple object");return e}G.assertObject=assertObject;function assertNotEmpty(e){assertSet(e);if("number"===typeof e&&0===e)throw new Error("must provide a non-zero value");if(0===e.length)throw new Error("must provide a non-empty value");return e}G.assertNotEmpty=assertNotEmpty;function optional(e,t){return void 0===e||null===e?t:e}G.optional=optional;function may(e,t){return void 0===t||null===t?void 0:e(t)}G.may=may;function dictionaryToStringMap(e){const t=new Map;for(const r of Object.keys(e)){const o=e[r];if("string"!==typeof o)throw new Error("Found dictionary value of type other than string");t.set(r,o)}return t}G.dictionaryToStringMap=dictionaryToStringMap;class Integer{static parse(e){const t="number"===typeof e?new K.Int53(e):K.Int53.fromString(e);return t.toNumber()}static encode(e){return new K.Int53(e).toString()}}G.Integer=Integer;function encodeString(e){const t=(0,z.toUtf8)(e);return Uint8Array.from([t.length,...t])}G.encodeString=encodeString;function encodeInt(e){return e>=128?Uint8Array.from([255&e|128,...encodeInt(e>>7)]):Uint8Array.from([255&e])}G.encodeInt=encodeInt;function encodeTime(e){const t=e.getTime();const r=Math.floor(t/1e3);const o=r?[8,...encodeInt(r)]:new Uint8Array;const s=(e.nanoseconds||0)+t%1e3*1e6;const n=s?[16,...encodeInt(s)]:new Uint8Array;return Uint8Array.from([...o,...n])}G.encodeTime=encodeTime;function encodeBytes(e){if(e.length>=128)throw new Error("Not implemented for byte arrays of length 128 or more");return e.length?Uint8Array.from([e.length,...e]):new Uint8Array}G.encodeBytes=encodeBytes;function encodeVersion(e){const t=e.block?Uint8Array.from([8,...encodeInt(e.block)]):new Uint8Array;const r=e.app?Uint8Array.from([16,...encodeInt(e.app)]):new Uint8Array;return Uint8Array.from([...t,...r])}G.encodeVersion=encodeVersion;function encodeBlockId(e){return Uint8Array.from([10,e.hash.length,...e.hash,18,e.parts.hash.length+4,8,e.parts.total,18,e.parts.hash.length,...e.parts.hash])}G.encodeBlockId=encodeBlockId;var L="default"in e?e.default:e;var Z={};Object.defineProperty(Z,"__esModule",{value:true});Z.hashBlock=Z.hashTx=void 0;const X=L;const Y=G;function hashTx(e){return(0,X.sha256)(e)}Z.hashTx=hashTx;function getSplitPoint(e){if(e<1)throw new Error("Cannot split an empty tree");const t=2**Math.floor(Math.log2(e));return t<e?t:t/2}function hashLeaf(e){const t=new X.Sha256(Uint8Array.from([0]));t.update(e);return t.digest()}function hashInner(e,t){const r=new X.Sha256(Uint8Array.from([1]));r.update(e);r.update(t);return r.digest()}function hashTree(e){switch(e.length){case 0:throw new Error("Cannot hash empty tree");case 1:return hashLeaf(e[0]);default:{const t=getSplitPoint(e.length);const r=hashTree(e.slice(0,t));const o=hashTree(e.slice(t));return hashInner(r,o)}}}function hashBlock(e){if(!e.lastBlockId)throw new Error("Hashing a block header with no last block ID (i.e. header at height 1) is not supported. If you need this, contributions are welcome. Please add documentation and test vectors for this case.");const t=[(0,Y.encodeVersion)(e.version),(0,Y.encodeString)(e.chainId),(0,Y.encodeInt)(e.height),(0,Y.encodeTime)(e.time),(0,Y.encodeBlockId)(e.lastBlockId),(0,Y.encodeBytes)(e.lastCommitHash),(0,Y.encodeBytes)(e.dataHash),(0,Y.encodeBytes)(e.validatorsHash),(0,Y.encodeBytes)(e.nextValidatorsHash),(0,Y.encodeBytes)(e.consensusHash),(0,Y.encodeBytes)(e.appHash),(0,Y.encodeBytes)(e.lastResultsHash),(0,Y.encodeBytes)(e.evidenceHash),(0,Y.encodeBytes)(e.proposerAddress)];return hashTree(t)}Z.hashBlock=hashBlock;var ee="default"in t?t.default:t;var te={};var re=te&&te.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);Object.defineProperty(e,o,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r);e[o]=t[r]});var oe=te&&te.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e.default=t});var se=te&&te.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&re(t,e,r);oe(t,e);return t};Object.defineProperty(te,"__esModule",{value:true});te.Params=void 0;
/* eslint-disable @typescript-eslint/naming-convention */const ne=ee;const ae=U;const ce=G;const ie=se(W);function encodeHeightParam(e){return{height:(0,ce.may)(ce.Integer.encode,e.height)}}function encodeBlockchainRequestParams(e){return{minHeight:(0,ce.may)(ce.Integer.encode,e.minHeight),maxHeight:(0,ce.may)(ce.Integer.encode,e.maxHeight)}}function encodeBlockSearchParams(e){return{query:e.query,page:(0,ce.may)(ce.Integer.encode,e.page),per_page:(0,ce.may)(ce.Integer.encode,e.per_page),order_by:e.order_by}}function encodeAbciQueryParams(e){return{path:(0,ce.assertNotEmpty)(e.path),data:(0,ne.toHex)(e.data),height:(0,ce.may)(ce.Integer.encode,e.height),prove:e.prove}}function encodeBroadcastTxParams(e){return{tx:(0,ne.toBase64)((0,ce.assertNotEmpty)(e.tx))}}function encodeTxParams(e){return{hash:(0,ne.toBase64)((0,ce.assertNotEmpty)(e.hash)),prove:e.prove}}function encodeTxSearchParams(e){return{query:e.query,prove:e.prove,page:(0,ce.may)(ce.Integer.encode,e.page),per_page:(0,ce.may)(ce.Integer.encode,e.per_page),order_by:e.order_by}}function encodeValidatorsParams(e){return{height:(0,ce.may)(ce.Integer.encode,e.height),page:(0,ce.may)(ce.Integer.encode,e.page),per_page:(0,ce.may)(ce.Integer.encode,e.per_page)}}class Params{static encodeAbciInfo(e){return(0,ae.createJsonRpcRequest)(e.method)}static encodeAbciQuery(e){return(0,ae.createJsonRpcRequest)(e.method,encodeAbciQueryParams(e.params))}static encodeBlock(e){return(0,ae.createJsonRpcRequest)(e.method,encodeHeightParam(e.params))}static encodeBlockchain(e){return(0,ae.createJsonRpcRequest)(e.method,encodeBlockchainRequestParams(e.params))}static encodeBlockResults(e){return(0,ae.createJsonRpcRequest)(e.method,encodeHeightParam(e.params))}static encodeBlockSearch(e){return(0,ae.createJsonRpcRequest)(e.method,encodeBlockSearchParams(e.params))}static encodeBroadcastTx(e){return(0,ae.createJsonRpcRequest)(e.method,encodeBroadcastTxParams(e.params))}static encodeCommit(e){return(0,ae.createJsonRpcRequest)(e.method,encodeHeightParam(e.params))}static encodeGenesis(e){return(0,ae.createJsonRpcRequest)(e.method)}static encodeHealth(e){return(0,ae.createJsonRpcRequest)(e.method)}static encodeStatus(e){return(0,ae.createJsonRpcRequest)(e.method)}static encodeSubscribe(e){const t={key:"tm.event",value:e.query.type};const r=ie.buildQuery({tags:[t],raw:e.query.raw});return(0,ae.createJsonRpcRequest)("subscribe",{query:r})}static encodeTx(e){return(0,ae.createJsonRpcRequest)(e.method,encodeTxParams(e.params))}static encodeTxSearch(e){return(0,ae.createJsonRpcRequest)(e.method,encodeTxSearchParams(e.params))}static encodeValidators(e){return(0,ae.createJsonRpcRequest)(e.method,encodeValidatorsParams(e.params))}}te.Params=Params;var de={};Object.defineProperty(de,"__esModule",{value:true});de.BlockIdFlag=void 0;(function(e){e[e.Unknown=0]="Unknown";e[e.Absent=1]="Absent";e[e.Commit=2]="Commit";e[e.Nil=3]="Nil";e[e.Unrecognized=-1]="Unrecognized"})(de.BlockIdFlag||(de.BlockIdFlag={}));var ue="default"in t?t.default:t;var le="default"in d?d.default:d;var pe={};Object.defineProperty(pe,"__esModule",{value:true});pe.Responses=void 0;
/* eslint-disable @typescript-eslint/naming-convention */const he=ue;const me=le;const fe=b;const ye=de;const be=G;const ge=Z;function decodeAbciInfo(e){return{data:e.data,lastBlockHeight:(0,be.may)(be.Integer.parse,e.last_block_height),lastBlockAppHash:(0,be.may)(he.fromBase64,e.last_block_app_hash)}}function decodeQueryProof(e){return{ops:e.ops.map((e=>({type:e.type,key:(0,he.fromBase64)(e.key),data:(0,he.fromBase64)(e.data)})))}}function decodeAbciQuery(e){return{key:(0,he.fromBase64)((0,be.optional)(e.key,"")),value:(0,he.fromBase64)((0,be.optional)(e.value,"")),proof:(0,be.may)(decodeQueryProof,e.proofOps),height:(0,be.may)(be.Integer.parse,e.height),code:(0,be.may)(be.Integer.parse,e.code),index:(0,be.may)(be.Integer.parse,e.index),log:e.log}}function decodeAttribute(e){return{key:(0,he.fromBase64)((0,be.assertNotEmpty)(e.key)),value:(0,he.fromBase64)((0,be.optional)(e.value,""))}}function decodeAttributes(e){return(0,be.assertArray)(e).map(decodeAttribute)}function decodeEvent(e){return{type:e.type,attributes:decodeAttributes(e.attributes)}}function decodeEvents(e){return(0,be.assertArray)(e).map(decodeEvent)}function decodeTxData(e){return{code:be.Integer.parse((0,be.assertNumber)((0,be.optional)(e.code,0))),codeSpace:e.codespace,log:e.log,data:(0,be.may)(he.fromBase64,e.data),events:e.events?decodeEvents(e.events):[],gasWanted:be.Integer.parse((0,be.optional)(e.gas_wanted,"0")),gasUsed:be.Integer.parse((0,be.optional)(e.gas_used,"0"))}}function decodePubkey(e){switch(e.type){case"tendermint/PubKeyEd25519":return{algorithm:"ed25519",data:(0,he.fromBase64)((0,be.assertNotEmpty)(e.value))};case"tendermint/PubKeySecp256k1":return{algorithm:"secp256k1",data:(0,he.fromBase64)((0,be.assertNotEmpty)(e.value))};default:throw new Error(`unknown pubkey type: ${e.type}`)}}function decodeValidatorUpdate(e){return{pubkey:decodePubkey((0,be.assertObject)(e.pub_key)),votingPower:be.Integer.parse((0,be.assertNotEmpty)(e.voting_power)),address:(0,he.fromHex)((0,be.assertNotEmpty)(e.address)),proposerPriority:be.Integer.parse(e.proposer_priority)}}function decodeBlockParams(e){return{maxBytes:be.Integer.parse((0,be.assertNotEmpty)(e.max_bytes)),maxGas:be.Integer.parse((0,be.assertNotEmpty)(e.max_gas))}}function decodeEvidenceParams(e){return{maxAgeNumBlocks:be.Integer.parse((0,be.assertNotEmpty)(e.max_age_num_blocks)),maxAgeDuration:be.Integer.parse((0,be.assertNotEmpty)(e.max_age_duration))}}function decodeConsensusParams(e){return{block:decodeBlockParams((0,be.assertObject)(e.block)),evidence:decodeEvidenceParams((0,be.assertObject)(e.evidence))}}function decodeBlockResults(e){return{height:be.Integer.parse((0,be.assertNotEmpty)(e.height)),results:(e.txs_results||[]).map(decodeTxData),validatorUpdates:(e.validator_updates||[]).map(decodeValidatorUpdate),consensusUpdates:(0,be.may)(decodeConsensusParams,e.consensus_param_updates),beginBlockEvents:decodeEvents(e.begin_block_events||[]),endBlockEvents:decodeEvents(e.end_block_events||[])}}function decodeBlockId(e){return{hash:(0,he.fromHex)((0,be.assertNotEmpty)(e.hash)),parts:{total:(0,be.assertNotEmpty)(e.parts.total),hash:(0,he.fromHex)((0,be.assertNotEmpty)(e.parts.hash))}}}function decodeBlockVersion(e){var t;return{block:be.Integer.parse(e.block),app:be.Integer.parse(null!==(t=e.app)&&void 0!==t?t:0)}}function decodeHeader(e){return{version:decodeBlockVersion(e.version),chainId:(0,be.assertNotEmpty)(e.chain_id),height:be.Integer.parse((0,be.assertNotEmpty)(e.height)),time:(0,fe.fromRfc3339WithNanoseconds)((0,be.assertNotEmpty)(e.time)),lastBlockId:e.last_block_id.hash?decodeBlockId(e.last_block_id):null,lastCommitHash:(0,he.fromHex)((0,be.assertSet)(e.last_commit_hash)),dataHash:(0,he.fromHex)((0,be.assertSet)(e.data_hash)),validatorsHash:(0,he.fromHex)((0,be.assertSet)(e.validators_hash)),nextValidatorsHash:(0,he.fromHex)((0,be.assertSet)(e.next_validators_hash)),consensusHash:(0,he.fromHex)((0,be.assertSet)(e.consensus_hash)),appHash:(0,he.fromHex)((0,be.assertSet)(e.app_hash)),lastResultsHash:(0,he.fromHex)((0,be.assertSet)(e.last_results_hash)),evidenceHash:(0,he.fromHex)((0,be.assertSet)(e.evidence_hash)),proposerAddress:(0,he.fromHex)((0,be.assertNotEmpty)(e.proposer_address))}}function decodeBlockMeta(e){return{blockId:decodeBlockId(e.block_id),blockSize:be.Integer.parse((0,be.assertNotEmpty)(e.block_size)),header:decodeHeader(e.header),numTxs:be.Integer.parse((0,be.assertNotEmpty)(e.num_txs))}}function decodeBlockchain(e){return{lastHeight:be.Integer.parse((0,be.assertNotEmpty)(e.last_height)),blockMetas:(0,be.assertArray)(e.block_metas).map(decodeBlockMeta)}}function decodeBroadcastTxSync(e){return{...decodeTxData(e),hash:(0,he.fromHex)((0,be.assertNotEmpty)(e.hash))}}function decodeBroadcastTxCommit(e){return{height:be.Integer.parse(e.height),hash:(0,he.fromHex)((0,be.assertNotEmpty)(e.hash)),checkTx:decodeTxData((0,be.assertObject)(e.check_tx)),deliverTx:(0,be.may)(decodeTxData,e.deliver_tx)}}function decodeBlockIdFlag(e){(0,me.assert)(e in ye.BlockIdFlag);return e}function decodeOptionalTime(e){const t=e&&!e.startsWith("0001-01-01");return t?(0,fe.fromRfc3339WithNanoseconds)(e):void 0}function decodeCommitSignature(e){return{blockIdFlag:decodeBlockIdFlag(e.block_id_flag),validatorAddress:e.validator_address?(0,he.fromHex)(e.validator_address):void 0,timestamp:decodeOptionalTime(e.timestamp),signature:e.signature?(0,he.fromBase64)(e.signature):void 0}}function decodeCommit(e){return{blockId:decodeBlockId((0,be.assertObject)(e.block_id)),height:be.Integer.parse((0,be.assertNotEmpty)(e.height)),round:be.Integer.parse(e.round),signatures:(0,be.assertArray)(e.signatures).map(decodeCommitSignature)}}function decodeCommitResponse(e){return{canonical:(0,be.assertBoolean)(e.canonical),header:decodeHeader(e.signed_header.header),commit:decodeCommit(e.signed_header.commit)}}function decodeValidatorGenesis(e){return{address:(0,he.fromHex)((0,be.assertNotEmpty)(e.address)),pubkey:decodePubkey((0,be.assertObject)(e.pub_key)),votingPower:be.Integer.parse((0,be.assertNotEmpty)(e.power))}}function decodeGenesis(e){return{genesisTime:(0,fe.fromRfc3339WithNanoseconds)((0,be.assertNotEmpty)(e.genesis_time)),chainId:(0,be.assertNotEmpty)(e.chain_id),consensusParams:decodeConsensusParams(e.consensus_params),validators:e.validators?(0,be.assertArray)(e.validators).map(decodeValidatorGenesis):[],appHash:(0,he.fromHex)((0,be.assertSet)(e.app_hash)),appState:e.app_state}}function decodeValidatorInfo(e){return{pubkey:decodePubkey((0,be.assertObject)(e.pub_key)),votingPower:be.Integer.parse((0,be.assertNotEmpty)(e.voting_power)),address:(0,he.fromHex)((0,be.assertNotEmpty)(e.address))}}function decodeNodeInfo(e){return{id:(0,he.fromHex)((0,be.assertNotEmpty)(e.id)),listenAddr:(0,be.assertNotEmpty)(e.listen_addr),network:(0,be.assertNotEmpty)(e.network),version:(0,be.assertString)(e.version),channels:(0,be.assertNotEmpty)(e.channels),moniker:(0,be.assertNotEmpty)(e.moniker),other:(0,be.dictionaryToStringMap)(e.other),protocolVersion:{app:be.Integer.parse((0,be.assertNotEmpty)(e.protocol_version.app)),block:be.Integer.parse((0,be.assertNotEmpty)(e.protocol_version.block)),p2p:be.Integer.parse((0,be.assertNotEmpty)(e.protocol_version.p2p))}}}function decodeSyncInfo(e){return{latestBlockHash:(0,he.fromHex)((0,be.assertNotEmpty)(e.latest_block_hash)),latestAppHash:(0,he.fromHex)((0,be.assertNotEmpty)(e.latest_app_hash)),latestBlockTime:(0,fe.fromRfc3339WithNanoseconds)((0,be.assertNotEmpty)(e.latest_block_time)),latestBlockHeight:be.Integer.parse((0,be.assertNotEmpty)(e.latest_block_height)),catchingUp:(0,be.assertBoolean)(e.catching_up)}}function decodeStatus(e){return{nodeInfo:decodeNodeInfo(e.node_info),syncInfo:decodeSyncInfo(e.sync_info),validatorInfo:decodeValidatorInfo(e.validator_info)}}function decodeTxProof(e){return{data:(0,he.fromBase64)((0,be.assertNotEmpty)(e.data)),rootHash:(0,he.fromHex)((0,be.assertNotEmpty)(e.root_hash)),proof:{total:be.Integer.parse((0,be.assertNotEmpty)(e.proof.total)),index:be.Integer.parse((0,be.assertNotEmpty)(e.proof.index)),leafHash:(0,he.fromBase64)((0,be.assertNotEmpty)(e.proof.leaf_hash)),aunts:(0,be.assertArray)(e.proof.aunts).map(he.fromBase64)}}}function decodeTxResponse(e){return{tx:(0,he.fromBase64)((0,be.assertNotEmpty)(e.tx)),result:decodeTxData((0,be.assertObject)(e.tx_result)),height:be.Integer.parse((0,be.assertNotEmpty)(e.height)),index:be.Integer.parse((0,be.assertNumber)(e.index)),hash:(0,he.fromHex)((0,be.assertNotEmpty)(e.hash)),proof:(0,be.may)(decodeTxProof,e.proof)}}function decodeTxSearch(e){return{totalCount:be.Integer.parse((0,be.assertNotEmpty)(e.total_count)),txs:(0,be.assertArray)(e.txs).map(decodeTxResponse)}}function decodeTxEvent(e){const t=(0,he.fromBase64)((0,be.assertNotEmpty)(e.tx));return{tx:t,hash:(0,ge.hashTx)(t),result:decodeTxData(e.result),height:be.Integer.parse((0,be.assertNotEmpty)(e.height)),index:(0,be.may)(be.Integer.parse,e.index)}}function decodeValidators(e){return{blockHeight:be.Integer.parse((0,be.assertNotEmpty)(e.block_height)),validators:(0,be.assertArray)(e.validators).map(decodeValidatorUpdate),count:be.Integer.parse((0,be.assertNotEmpty)(e.count)),total:be.Integer.parse((0,be.assertNotEmpty)(e.total))}}function decodeBlock(e){var t,r;return{header:decodeHeader((0,be.assertObject)(e.header)),lastCommit:e.last_commit.block_id.hash?decodeCommit((0,be.assertObject)(e.last_commit)):null,txs:e.data.txs?(0,be.assertArray)(e.data.txs).map(he.fromBase64):[],evidence:null!==(r=null===(t=e.evidence)||void 0===t?void 0:t.evidence)&&void 0!==r?r:[]}}function decodeBlockResponse(e){return{blockId:decodeBlockId(e.block_id),block:decodeBlock(e.block)}}function decodeBlockSearch(e){return{totalCount:be.Integer.parse((0,be.assertNotEmpty)(e.total_count)),blocks:(0,be.assertArray)(e.blocks).map(decodeBlockResponse)}}class Responses{static decodeAbciInfo(e){return decodeAbciInfo((0,be.assertObject)(e.result.response))}static decodeAbciQuery(e){return decodeAbciQuery((0,be.assertObject)(e.result.response))}static decodeBlock(e){return decodeBlockResponse(e.result)}static decodeBlockResults(e){return decodeBlockResults(e.result)}static decodeBlockSearch(e){return decodeBlockSearch(e.result)}static decodeBlockchain(e){return decodeBlockchain(e.result)}static decodeBroadcastTxSync(e){return decodeBroadcastTxSync(e.result)}static decodeBroadcastTxAsync(e){return Responses.decodeBroadcastTxSync(e)}static decodeBroadcastTxCommit(e){return decodeBroadcastTxCommit(e.result)}static decodeCommit(e){return decodeCommitResponse(e.result)}static decodeGenesis(e){return decodeGenesis((0,be.assertObject)(e.result.genesis))}static decodeHealth(){return null}static decodeStatus(e){return decodeStatus(e.result)}static decodeNewBlockEvent(e){return decodeBlock(e.data.value.block)}static decodeNewBlockHeaderEvent(e){return decodeHeader(e.data.value.header)}static decodeTxEvent(e){return decodeTxEvent(e.data.value.TxResult)}static decodeTx(e){return decodeTxResponse(e.result)}static decodeTxSearch(e){return decodeTxSearch(e.result)}static decodeValidators(e){return decodeValidators(e.result)}}pe.Responses=Responses;var ke={};Object.defineProperty(ke,"__esModule",{value:true});ke.adaptor34=void 0;const ve=Z;const Se=te;const Te=pe;ke.adaptor34={params:Se.Params,responses:Te.Responses,hashTx:ve.hashTx,hashBlock:ve.hashBlock};var xe={};var we=xe&&xe.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);Object.defineProperty(e,o,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r);e[o]=t[r]});var _e=xe&&xe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e.default=t});var Be=xe&&xe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&we(t,e,r);_e(t,e);return t};Object.defineProperty(xe,"__esModule",{value:true});xe.Tendermint34Client=void 0;const Re=U;const Ee=M;const Pe=ke;const Ie=Be(W);class Tendermint34Client$1{constructor(e){this.client=e;this.p=Pe.adaptor34.params;this.r=Pe.adaptor34.responses}static async connect(e){if("object"===typeof e)return Tendermint34Client$1.create(new Ee.HttpClient(e));{const t=e.startsWith("http://")||e.startsWith("https://");const r=t?new Ee.HttpClient(e):new Ee.WebsocketClient(e);return Tendermint34Client$1.create(r)}}static async create(e){await this.detectVersion(e);return new Tendermint34Client$1(e)}static async detectVersion(e){const t=(0,Re.createJsonRpcRequest)(Ie.Method.Status);const r=await e.execute(t);const o=r.result;if(!o||!o.node_info)throw new Error("Unrecognized format for status response");const s=o.node_info.version;if("string"!==typeof s)throw new Error("Unrecognized version format: must be string");return s}disconnect(){this.client.disconnect()}async abciInfo(){const e={method:Ie.Method.AbciInfo};return this.doCall(e,this.p.encodeAbciInfo,this.r.decodeAbciInfo)}async abciQuery(e){const t={params:e,method:Ie.Method.AbciQuery};return this.doCall(t,this.p.encodeAbciQuery,this.r.decodeAbciQuery)}async block(e){const t={method:Ie.Method.Block,params:{height:e}};return this.doCall(t,this.p.encodeBlock,this.r.decodeBlock)}async blockResults(e){const t={method:Ie.Method.BlockResults,params:{height:e}};return this.doCall(t,this.p.encodeBlockResults,this.r.decodeBlockResults)}async blockSearch(e){const t={params:e,method:Ie.Method.BlockSearch};const r=await this.doCall(t,this.p.encodeBlockSearch,this.r.decodeBlockSearch);return{...r,blocks:[...r.blocks].sort(((e,t)=>e.block.header.height-t.block.header.height))}}async blockSearchAll(e){let t=e.page||1;const r=[];let o=false;while(!o){const s=await this.blockSearch({...e,page:t});r.push(...s.blocks);r.length<s.totalCount?t++:o=true}r.sort(((e,t)=>e.block.header.height-t.block.header.height));return{totalCount:r.length,blocks:r}}
/**
   * Queries block headers filtered by minHeight <= height <= maxHeight.
   *
   * @param minHeight The minimum height to be included in the result. Defaults to 0.
   * @param maxHeight The maximum height to be included in the result. Defaults to infinity.
   */async blockchain(e,t){const r={method:Ie.Method.Blockchain,params:{minHeight:e,maxHeight:t}};return this.doCall(r,this.p.encodeBlockchain,this.r.decodeBlockchain)}async broadcastTxSync(e){const t={params:e,method:Ie.Method.BroadcastTxSync};return this.doCall(t,this.p.encodeBroadcastTx,this.r.decodeBroadcastTxSync)}async broadcastTxAsync(e){const t={params:e,method:Ie.Method.BroadcastTxAsync};return this.doCall(t,this.p.encodeBroadcastTx,this.r.decodeBroadcastTxAsync)}async broadcastTxCommit(e){const t={params:e,method:Ie.Method.BroadcastTxCommit};return this.doCall(t,this.p.encodeBroadcastTx,this.r.decodeBroadcastTxCommit)}async commit(e){const t={method:Ie.Method.Commit,params:{height:e}};return this.doCall(t,this.p.encodeCommit,this.r.decodeCommit)}async genesis(){const e={method:Ie.Method.Genesis};return this.doCall(e,this.p.encodeGenesis,this.r.decodeGenesis)}async health(){const e={method:Ie.Method.Health};return this.doCall(e,this.p.encodeHealth,this.r.decodeHealth)}async status(){const e={method:Ie.Method.Status};return this.doCall(e,this.p.encodeStatus,this.r.decodeStatus)}subscribeNewBlock(){const e={method:Ie.Method.Subscribe,query:{type:Ie.SubscriptionEventType.NewBlock}};return this.subscribe(e,this.r.decodeNewBlockEvent)}subscribeNewBlockHeader(){const e={method:Ie.Method.Subscribe,query:{type:Ie.SubscriptionEventType.NewBlockHeader}};return this.subscribe(e,this.r.decodeNewBlockHeaderEvent)}subscribeTx(e){const t={method:Ie.Method.Subscribe,query:{type:Ie.SubscriptionEventType.Tx,raw:e}};return this.subscribe(t,this.r.decodeTxEvent)}async tx(e){const t={params:e,method:Ie.Method.Tx};return this.doCall(t,this.p.encodeTx,this.r.decodeTx)}async txSearch(e){const t={params:e,method:Ie.Method.TxSearch};return this.doCall(t,this.p.encodeTxSearch,this.r.decodeTxSearch)}async txSearchAll(e){let t=e.page||1;const r=[];let o=false;while(!o){const s=await this.txSearch({...e,page:t});r.push(...s.txs);r.length<s.totalCount?t++:o=true}return{totalCount:r.length,txs:r}}async validators(e){const t={method:Ie.Method.Validators,params:e};return this.doCall(t,this.p.encodeValidators,this.r.decodeValidators)}async validatorsAll(e){const t=[];let r=1;let o=false;let s=e;while(!o){const e=await this.validators({per_page:50,height:s,page:r});t.push(...e.validators);s=s||e.blockHeight;t.length<e.total?r++:o=true}return{blockHeight:null!==s&&void 0!==s?s:0,count:t.length,total:t.length,validators:t}}async doCall(e,t,r){const o=t(e);const s=await this.client.execute(o);return r(s)}subscribe(e,t){if(!(0,Ee.instanceOfRpcStreamingClient)(this.client))throw new Error("This RPC client type cannot subscribe to events");const r=this.p.encodeSubscribe(e);const o=this.client.listen(r);return o.map((e=>t(e)))}}xe.Tendermint34Client=Tendermint34Client$1;var Ne={};Object.defineProperty(Ne,"__esModule",{value:true});Ne.Tendermint34Client=Ne.VoteType=Ne.broadcastTxSyncSuccess=Ne.broadcastTxCommitSuccess=Ne.SubscriptionEventType=Ne.Method=void 0;var Ce=W;Object.defineProperty(Ne,"Method",{enumerable:true,get:function(){return Ce.Method}});Object.defineProperty(Ne,"SubscriptionEventType",{enumerable:true,get:function(){return Ce.SubscriptionEventType}});var Ae=J;Object.defineProperty(Ne,"broadcastTxCommitSuccess",{enumerable:true,get:function(){return Ae.broadcastTxCommitSuccess}});Object.defineProperty(Ne,"broadcastTxSyncSuccess",{enumerable:true,get:function(){return Ae.broadcastTxSyncSuccess}});Object.defineProperty(Ne,"VoteType",{enumerable:true,get:function(){return Ae.VoteType}});var je=xe;Object.defineProperty(Ne,"Tendermint34Client",{enumerable:true,get:function(){return je.Tendermint34Client}});var Oe={};var He=Oe&&Oe.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);Object.defineProperty(e,o,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r);e[o]=t[r]});var Me=Oe&&Oe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e.default=t});var qe=Oe&&Oe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&He(t,e,r);Me(t,e);return t};Object.defineProperty(Oe,"__esModule",{value:true});Oe.BlockIdFlag=Oe.Tendermint34Client=Oe.tendermint34=Oe.VoteType=Oe.SubscriptionEventType=Oe.Method=Oe.broadcastTxSyncSuccess=Oe.broadcastTxCommitSuccess=Oe.WebsocketClient=Oe.HttpClient=Oe.toSeconds=Oe.toRfc3339WithNanoseconds=Oe.fromSeconds=Oe.fromRfc3339WithNanoseconds=Oe.DateTime=Oe.rawSecp256k1PubkeyToRawAddress=Oe.rawEd25519PubkeyToRawAddress=Oe.pubkeyToRawAddress=Oe.pubkeyToAddress=void 0;var Ve=p;Object.defineProperty(Oe,"pubkeyToAddress",{enumerable:true,get:function(){return Ve.pubkeyToAddress}});Object.defineProperty(Oe,"pubkeyToRawAddress",{enumerable:true,get:function(){return Ve.pubkeyToRawAddress}});Object.defineProperty(Oe,"rawEd25519PubkeyToRawAddress",{enumerable:true,get:function(){return Ve.rawEd25519PubkeyToRawAddress}});Object.defineProperty(Oe,"rawSecp256k1PubkeyToRawAddress",{enumerable:true,get:function(){return Ve.rawSecp256k1PubkeyToRawAddress}});var $e=b;Object.defineProperty(Oe,"DateTime",{enumerable:true,get:function(){return $e.DateTime}});Object.defineProperty(Oe,"fromRfc3339WithNanoseconds",{enumerable:true,get:function(){return $e.fromRfc3339WithNanoseconds}});Object.defineProperty(Oe,"fromSeconds",{enumerable:true,get:function(){return $e.fromSeconds}});Object.defineProperty(Oe,"toRfc3339WithNanoseconds",{enumerable:true,get:function(){return $e.toRfc3339WithNanoseconds}});Object.defineProperty(Oe,"toSeconds",{enumerable:true,get:function(){return $e.toSeconds}});var We=M;Object.defineProperty(Oe,"HttpClient",{enumerable:true,get:function(){return We.HttpClient}});Object.defineProperty(Oe,"WebsocketClient",{enumerable:true,get:function(){return We.WebsocketClient}});var Je=Ne;Object.defineProperty(Oe,"broadcastTxCommitSuccess",{enumerable:true,get:function(){return Je.broadcastTxCommitSuccess}});Object.defineProperty(Oe,"broadcastTxSyncSuccess",{enumerable:true,get:function(){return Je.broadcastTxSyncSuccess}});Object.defineProperty(Oe,"Method",{enumerable:true,get:function(){return Je.Method}});Object.defineProperty(Oe,"SubscriptionEventType",{enumerable:true,get:function(){return Je.SubscriptionEventType}});Object.defineProperty(Oe,"VoteType",{enumerable:true,get:function(){return Je.VoteType}});Oe.tendermint34=qe(Ne);var Ue=Ne;Object.defineProperty(Oe,"Tendermint34Client",{enumerable:true,get:function(){return Ue.Tendermint34Client}});var De=de;Object.defineProperty(Oe,"BlockIdFlag",{enumerable:true,get:function(){return De.BlockIdFlag}});const Qe=Oe.__esModule,Fe=Oe.BlockIdFlag,Ge=Oe.Tendermint34Client,ze=Oe.tendermint34,Ke=Oe.VoteType,Le=Oe.SubscriptionEventType,Ze=Oe.Method,Xe=Oe.broadcastTxSyncSuccess,Ye=Oe.broadcastTxCommitSuccess,et=Oe.WebsocketClient,tt=Oe.HttpClient,rt=Oe.toSeconds,ot=Oe.toRfc3339WithNanoseconds,st=Oe.fromSeconds,nt=Oe.fromRfc3339WithNanoseconds,at=Oe.DateTime,ct=Oe.rawSecp256k1PubkeyToRawAddress,it=Oe.rawEd25519PubkeyToRawAddress,dt=Oe.pubkeyToRawAddress,ut=Oe.pubkeyToAddress;export{Fe as BlockIdFlag,at as DateTime,tt as HttpClient,Ze as Method,Le as SubscriptionEventType,Ge as Tendermint34Client,Ke as VoteType,et as WebsocketClient,Qe as __esModule,Ye as broadcastTxCommitSuccess,Xe as broadcastTxSyncSuccess,Oe as default,nt as fromRfc3339WithNanoseconds,st as fromSeconds,ut as pubkeyToAddress,dt as pubkeyToRawAddress,it as rawEd25519PubkeyToRawAddress,ct as rawSecp256k1PubkeyToRawAddress,ze as tendermint34,ot as toRfc3339WithNanoseconds,rt as toSeconds};

